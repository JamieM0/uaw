# CLAUDE.md - Web Frontend

This file provides guidance to Claude Code (claude.ai/code) when working with the web frontend of the Universal Automation Wiki.

## Frontend Overview

The UAW web frontend is a static site with rich interactive features, built with vanilla JavaScript, modular CSS, and no framework dependencies. It serves simulation playgrounds, category browsing, and article rendering.

## Local Development

### Quick Start
```bash
cd web
python3 -m http.server 8000
```

### Access Points
- **Main site**: http://localhost:8000/
- **Playground**: http://localhost:8000/playground.html  
- **Documentation**: http://localhost:8000/docs/
- **Categories**: http://localhost:8000/technology/, /manufacturing/, etc.

### Testing Protocol
1. **Playground functionality**: Load playground.html, click "Load Sample", verify "✓ Valid JSON"
2. **Navigation**: Test category navigation and article links
3. **Responsive design**: Check mobile/desktop layouts
4. **JavaScript console**: Verify no errors on page load

## Architecture

### Directory Structure
```
web/
├── assets/
│   ├── css/           # Modular stylesheets
│   ├── js/            # Component-based JavaScript
│   ├── images/        # Logos, icons, SVG graphics
│   ├── static/        # JSON data files for client-side processing
│   └── data/          # Static content data
├── docs/              # Documentation pages
├── [categories]/      # Technology, manufacturing, healthcare, etc.
├── index.html         # Main landing page
└── playground.html    # Interactive simulation editor
```

### CSS Architecture
- **main.css**: Core variables, typography, layout primitives
- **components.css**: Reusable UI components and cards
- **simulation.css**: Simulation player and visualization styles
- **playground.css**: Interactive editor and Monaco integration
- **category.css**: Category page layouts and navigation
- **responsive.css**: Mobile-first responsive design

### JavaScript Components
- **playground.js**: Main application logic for simulation editor
- **simulation-validator.js**: Client-side validation engine (Universal Object Model compliant)
- **simulation-player.js**: Timeline playback and animation system
- **simulation-viewer.js**: Static simulation rendering for articles
- **tree-viewer.js**: Hierarchical process tree display
- **space-editor.js**: Visual drag-and-drop timeline editor
- **components.js**: Shared UI utilities and helpers

## Key Features

### Simulation Playground
- **Monaco Editor**: External CDN dependency for JSON editing with syntax highlighting
- **Real-time Validation**: Uses `metrics-catalog.json` for computational checks
- **Visual Timeline**: Drag-and-drop interface for editing task timing and resources
- **Sample Loading**: Pre-built simulation examples for testing
- **Export/Import**: JSON download and file upload capabilities

### Validation System
- **Metrics Catalog**: `assets/static/metrics-catalog.json` defines validation rules
- **Computational Validation**: JavaScript functions for structural and logical checks
- **Error Reporting**: Categorized by severity (error, warning, info)
- **Universal Object Model**: Standardized simulation data structure

### Content Rendering
- **Category Navigation**: Auto-generated from directory structure
- **Article Pages**: Rendered from backend JSON via Jinja2 templates
- **Persona Filtering**: Client-side filtering based on user type
- **Interactive Elements**: Tabbed content, expandable sections

## Data Files

### Static JSON Assets
- **metrics-catalog.json**: Validation rules and computational functions
- **tutorial-content.json**: Playground tutorial content and examples

### Generated Content
Articles are generated by the backend pipeline and include embedded simulation data for the JavaScript player to consume.

## External Dependencies

### CDN Resources
- **Google Fonts**: Inter, IBM Plex Sans, Geologica font families
- **Monaco Editor**: Code editor with JSON syntax highlighting (`unpkg.com`)
- **Font Awesome**: Icon fonts (if used)

### Graceful Degradation
- External font loading with fallbacks to system fonts
- Monaco editor degrades to basic textarea if CDN blocked
- Core functionality preserved without external resources

## Development Guidelines

### Adding New JavaScript Components
1. Create modular files in `assets/js/`
2. Follow existing naming pattern: `component-name.js`
3. Use revealing module pattern or ES6 classes
4. Include error handling for missing dependencies
5. Add console logging for debugging

### CSS Best Practices
- Use CSS custom properties (variables) defined in `main.css`
- Follow BEM-like naming for component styles
- Mobile-first responsive approach
- Maintain component modularity

### Validation Rule Development
1. Add new metrics to `assets/static/metrics-catalog.json`
2. Implement corresponding JavaScript function in `simulation-validator.js`
3. Follow naming pattern: `validate[MetricName]`
4. Include error handling and descriptive messages

## Common Issues

### Monaco Editor Problems
- **Loading failure**: Check CDN availability and network restrictions
- **Syntax highlighting missing**: Verify Monaco loader script execution
- **Editor not initializing**: Check for JavaScript errors in console

### Validation Issues
- **Metrics not loading**: Verify `metrics-catalog.json` syntax and fetch success
- **Functions not found**: Ensure validation function names match catalog entries
- **Performance**: Large simulations may require debounced validation

### Static File Serving
- **404 errors**: Verify relative paths from current page location
- **CORS issues**: Use proper local server (not file:// protocol)
- **Cache issues**: Use browser dev tools to disable cache during development

## Browser Compatibility

### Minimum Requirements
- ES6+ JavaScript support (modern browsers)
- CSS Grid and Flexbox support
- Fetch API for JSON loading
- LocalStorage for playground state persistence

### Testing Targets
- Chrome/Edge (latest)
- Firefox (latest) 
- Safari (latest)
- Mobile browsers (iOS Safari, Chrome Mobile)

## Performance Considerations

### Loading Optimization
- CSS variables for consistent theming without JavaScript
- Lazy loading of Monaco editor until playground interaction
- Minimal inline styles to prevent layout shift
- Placeholder elements to reserve space during loading

### Runtime Performance  
- Debounced validation to prevent excessive computation
- Efficient DOM manipulation in simulation player
- Memory management for large simulation datasets
- Event delegation for dynamic content