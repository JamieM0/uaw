<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation - Universal Automation Wiki</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/components.css">
    <link rel="stylesheet" href="/assets/css/category.css"> <!-- For nav cards -->
    <link rel="stylesheet" href="/assets/css/responsive.css">
    <link rel="stylesheet" href="/assets/css/documentation.css"> <!-- Added documentation styles -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600;700&family=Geologica:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* Placeholder styles to prevent layout shift */
        #header-placeholder { min-height: 70px; }
        #footer-placeholder { min-height: 250px; }
    </style>
</head>
<body>
    <div id="header-placeholder"></div>

    <div class="docs-layout">
        <div id="sidebar-placeholder"></div>

        <main>
            <section class="hero">
                <div class="container">
                    <h1>UAW Documentation</h1>
                    <p class="hero-subtitle">- [Architecture Overview](#page-1)</p>
                </div>
            </section>
            <div class="spacer"></div>
            <section class="content-section">
                <div class="spacer"></div>

                <h1>UAW Documentation</h1>
<h2>Table of Contents</h2>
<ul>
<li><a href="#page-1">Architecture Overview</a></li>
<li><a href="#page-2">Core Utilities and Functionality</a></li>
<li><a href="#page-3">Example Workflows and Use Cases</a></li>
<li><a href="#page-4">Extending and Customizing Routines</a></li>
<li><a href="#page-5">Natural Language Processing and Simplification</a></li>
<li><a href="#page-6">Search Query Generation and Information Retrieval</a></li>
</ul>
<p><a id='page-1'></a></p>
<h2>Architecture Overview</h2>
<h3>Related Files</h3>
<ul>
<li><code>assemble.py</code></li>
<li><code>utils.py</code></li>
<li><code>automation-adoption.py</code></li>
</ul>
<h3>Related Pages</h3>
<p>Related topics: <a href="#page-2">Core Utilities and Functionality</a>, <a href="#page-3">Example Workflows and Use Cases</a></p>
<h3>Architecture Overview</h3>
<p>This document provides an overview of the architecture of the <code>routines</code> repository, focusing on <code>assemble.py</code>, <code>utils.py</code>, and <code>automation-adoption.py</code>.  It details their purpose, functionality, and relationships within the system.</p>
<h4>1. Purpose and Functionality</h4>
<ul>
<li>
<p><strong><code>assemble.py</code></strong>: This script likely contains the main program logic for assembling or orchestrating different routines or tasks.  It might involve reading input data, calling various functions from other modules (like <code>utils.py</code>), and generating output.</p>
</li>
<li>
<p><strong><code>utils.py</code></strong>: This module serves as a collection of utility functions used throughout the project.  These functions could include file I/O, data manipulation, string processing, or any other common tasks needed by multiple scripts.</p>
</li>
<li>
<p><strong><code>automation-adoption.py</code></strong>: This script focuses on generating and analyzing automation adoption phases for a given topic. It uses a Large Language Model (LLM) to create a structured breakdown of automation, from basic mechanical assistance to full end-to-end automation.</p>
</li>
</ul>
<h4>2. Code Examples and Explanations</h4>
<h5><code>assemble.py</code> (Hypothetical Example)</h5>
<div class="codehilite"><pre><span></span><code><span class="c1"># assemble.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">utils</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="s2">&quot;input.json&quot;</span><span class="p">)</span>
    <span class="n">processed_data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">save_output</span><span class="p">(</span><span class="n">processed_data</span><span class="p">,</span> <span class="s2">&quot;output.json&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

<p>Explanation: This example demonstrates how <code>assemble.py</code> might use functions from <code>utils.py</code> to load data, process it, and save the output.</p>
<h5><code>utils.py</code> (Example)</h5>
<div class="codehilite"><pre><span></span><code><span class="c1"># utils.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">def</span><span class="w"> </span><span class="nf">load_json</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">save_output</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1"># Example data processing logic</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</code></pre></div>

<p>Explanation: This code shows example utility functions for loading JSON data, saving output, and processing data.  The <code>process_data</code> function converts all values in a dictionary to uppercase.</p>
<h5><code>automation-adoption.py</code> (Key Functions)</h5>
<div class="codehilite"><pre><span></span><code><span class="c1"># automation-adoption.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">chat_with_llm</span><span class="p">,</span> <span class="n">parse_llm_json_response</span><span class="p">,</span> <span class="n">saveToFile</span>

<span class="n">flowUUID</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Global variable for flow UUID</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_automation_adoption</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">save_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate detailed information about automation adoption phases for a specific topic.&quot;&quot;&quot;</span>
    <span class="c1"># Extract information from input data</span>
    <span class="n">topic</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;topic&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;gemma3&quot;</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="c1"># Generate automation adoption phases using LLM</span>
    <span class="n">systemMsg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;You are an AI assistant specialized in analyzing automation adoption patterns. &quot;</span>
        <span class="s2">&quot;Your task is to identify and explain the different phases of automation adoption &quot;</span>
        <span class="s2">&quot;in a specific field or topic, from basic mechanical assistance to full end-to-end automation.&quot;</span>
    <span class="p">)</span>

    <span class="n">user_msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Create a detailed breakdown of automation adoption phases for: </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Please structure your response in 4 phases:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Phase 1: Basic Mechanical Assistance (Currently widespread)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Phase 2: Integrated Semi-Automation (Currently in transition)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Phase 3: Advanced Automation Systems (Emerging technology)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Phase 4: Full End-to-End Automation (Future development)</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;For each phase:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;1. Provide 4-6 specific examples of automation technology or processes</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;2. Make sure the automation complexity increases with each phase</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;3. Be specific to the domain rather than generic</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Format your response as a JSON object with the following structure:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;{</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase1</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;    </span><span class="se">\&quot;</span><span class="s2">title</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Basic Mechanical Assistance</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;    </span><span class="se">\&quot;</span><span class="s2">status</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Currently widespread</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;    </span><span class="se">\&quot;</span><span class="s2">examples</span><span class="se">\&quot;</span><span class="s2">: [</span><span class="se">\&quot;</span><span class="s2">example1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">example2</span><span class="se">\&quot;</span><span class="s2">, ...]</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  },</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase2</span><span class="se">\&quot;</span><span class="s2">: { ... },</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase3</span><span class="se">\&quot;</span><span class="s2">: { ... },</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase4</span><span class="se">\&quot;</span><span class="s2">: { ... }</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Only include examples that are significantly relevant to the topic.&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Save inputs to file if requested</span>
    <span class="k">if</span> <span class="n">save_inputs</span><span class="p">:</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;flow/</span><span class="si">{</span><span class="n">flowUUID</span><span class="si">}</span><span class="s2">/inputs/5-in.json&quot;</span>
        <span class="n">saveToFile</span><span class="p">(</span><span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">save_path</span><span class="p">)</span>

    <span class="c1"># Use chat_with_llm to generate automation adoption phases</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat_with_llm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Try to parse JSON response</span>
        <span class="n">adoption_phases</span> <span class="o">=</span> <span class="n">parse_llm_json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">adoption_phases</span>
    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: LLM response is not valid JSON. Full response: &quot;</span> <span class="o">+</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>

<p>Explanation:</p>
<ul>
<li><code>generate_automation_adoption</code>: This function takes input data (including a topic, model, and parameters), constructs system and user messages for an LLM, calls the LLM using <code>chat_with_llm</code> (likely from <code>utils.py</code>), and parses the JSON response.  It handles potential JSON decoding errors.</li>
<li>It uses <code>utils.saveToFile</code> to save inputs if requested.</li>
<li>It relies on <code>utils.parse_llm_json_response</code> to reliably extract a JSON block from the LLM response.</li>
</ul>
<h4>3. Architectural Fit</h4>
<p>The scripts fit together in a modular architecture:</p>
<ul>
<li><code>assemble.py</code> acts as the entry point, orchestrating the overall process.</li>
<li><code>utils.py</code> provides reusable functions for common tasks, promoting code reuse and maintainability.</li>
<li><code>automation-adoption.py</code> encapsulates the specific logic for generating automation adoption phases, making it a self-contained component.</li>
</ul>
<p>Here's a Mermaid diagram illustrating the component relationships:</p>
<div class="codehilite"><pre><span></span><code><span class="nf">graph</span><span class="w"> </span><span class="n">TD</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">assemble</span><span class="p">.</span><span class="n">py</span><span class="p">]</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">utils</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">A</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="p">.</span><span class="n">py</span><span class="p">]</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">B</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">f9f</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">ccf</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">ccf</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
</code></pre></div>

<p>Explanation: <code>assemble.py</code> depends on both <code>utils.py</code> and <code>automation-adoption.py</code>. <code>automation-adoption.py</code> also uses functions from <code>utils.py</code>.</p>
<h4>4. Setup and Usage Instructions</h4>
<ol>
<li><strong>Installation:</strong> Ensure you have Python installed. Install any necessary dependencies (e.g., requests for <code>chat_with_llm</code>).</li>
<li><strong>Configuration:</strong> Configure the LLM connection details (API key, endpoint) within <code>utils.py</code> or a separate configuration file.</li>
<li>
<p><strong>Usage:</strong></p>
<ul>
<li>For <code>assemble.py</code>, create an <code>input.json</code> file with the required input data.  Run the script: <code>python assemble.py</code>.</li>
<li>For <code>automation-adoption.py</code>, create an input JSON file specifying the topic, model, and parameters.  Then, modify the <code>main()</code> function in <code>automation-adoption.py</code> to load your input file and call <code>generate_automation_adoption</code>.  Run the script: <code>python automation-adoption.py</code>.</li>
</ul>
</li>
</ol>
<h4>Data Flow Diagram</h4>
<p>This Mermaid diagram shows the data flow in <code>automation-adoption.py</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">sequenceDiagram</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">User</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">assemble</span><span class="p">.</span><span class="n">py</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="p">.</span><span class="n">py</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">utils</span><span class="p">.</span><span class="n">py</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">LLM</span>

<span class="w">    </span><span class="n">User</span><span class="o">-&gt;&gt;</span><span class="n">assemble</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="n">assemble</span><span class="p">.</span><span class="n">py</span>
<span class="w">    </span><span class="n">assemble</span><span class="p">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">generate_automation_adoption</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
<span class="w">    </span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="p">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">utils</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">chat_with_llm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">systemMsg</span><span class="p">,</span><span class="w"> </span><span class="n">user_msg</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">)</span>
<span class="w">    </span><span class="n">utils</span><span class="p">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">LLM</span><span class="o">:</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="n">prompt</span>
<span class="w">    </span><span class="n">LLM</span><span class="o">--&gt;&gt;</span><span class="n">utils</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="w"> </span><span class="kr">Return</span><span class="w"> </span><span class="n">response</span>
<span class="w">    </span><span class="n">utils</span><span class="p">.</span><span class="n">py</span><span class="o">--&gt;&gt;</span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="w"> </span><span class="kr">Return</span><span class="w"> </span><span class="n">response</span>
<span class="w">    </span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="p">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">utils</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">parse_llm_json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">    </span><span class="n">utils</span><span class="p">.</span><span class="n">py</span><span class="o">--&gt;&gt;</span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="w"> </span><span class="kr">Return</span><span class="w"> </span><span class="n">metadata</span>
<span class="w">    </span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="p">.</span><span class="n">py</span><span class="o">--&gt;&gt;</span><span class="n">assemble</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="w"> </span><span class="kr">Return</span><span class="w"> </span><span class="n">adoption_phases</span>
<span class="w">    </span><span class="n">assemble</span><span class="p">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">User</span><span class="o">:</span><span class="w"> </span><span class="kr">Output</span><span class="w"> </span><span class="n">result</span>
</code></pre></div>

<p>Explanation:</p>
<ol>
<li>The user runs <code>assemble.py</code>, which calls <code>generate_automation_adoption</code> in <code>automation-adoption.py</code>.</li>
<li><code>automation-adoption.py</code> calls <code>chat_with_llm</code> in <code>utils.py</code> to interact with the LLM.</li>
<li>The LLM returns a response to <code>utils.py</code>, which passes it back to <code>automation-adoption.py</code>.</li>
<li><code>automation-adoption.py</code> uses <code>parse_llm_json_response</code> to extract the JSON.</li>
<li>The result is returned to <code>assemble.py</code> and then to the user.</li>
</ol>
<hr />
<p><a id='page-2'></a></p>
<h2>Core Utilities and Functionality</h2>
<h3>Related Files</h3>
<ul>
<li><code>utils.py</code></li>
<li><code>prompt.py</code></li>
<li><code>reconstructor.py</code></li>
</ul>
<h3>Related Pages</h3>
<p>Related topics: <a href="#page-1">Architecture Overview</a>, <a href="#page-3">Example Workflows and Use Cases</a></p>
<h1>Core Utilities and Functionality</h1>
<p>This page details the core utilities and functionality provided by the <code>utils.py</code>, <code>prompt.py</code>, and <code>reconstructor.py</code> files within the <code>routines</code> repository. These components offer essential tools for various tasks within the larger system.</p>
<h2>1. Purpose and Functionality</h2>
<ul>
<li><strong><code>utils.py</code></strong>: Contains general-purpose utility functions used throughout the project. This includes helper functions for file I/O, data manipulation, and other common tasks.</li>
<li><strong><code>prompt.py</code></strong>: Focuses on generating prompts for Large Language Models (LLMs). It provides functions to construct prompts based on predefined templates and input data.</li>
<li><strong><code>reconstructor.py</code></strong>: Implements functionality to parse and reconstruct data, specifically JSON responses from LLMs. This is crucial for reliably extracting structured information from the text-based output of LLMs.</li>
</ul>
<h2>2. Code Examples and Explanations</h2>
<h3><code>utils.py</code></h3>
<p>Example function (assuming a function <code>load_json</code> exists in <code>utils.py</code>):</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># utils.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">def</span><span class="w"> </span><span class="nf">load_json</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads JSON data from a file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filepath (str): The path to the JSON file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The loaded JSON data as a dictionary.</span>
<span class="sd">        None: If the file does not exist or contains invalid JSON.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: File not found at </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Invalid JSON in file </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>

<p>Explanation:</p>
<p>This function attempts to open and parse a JSON file. It includes error handling for common issues like the file not existing or containing invalid JSON.  Error messages are printed to the console, and <code>None</code> is returned to indicate failure.</p>
<h3><code>prompt.py</code></h3>
<p>Example function:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># prompt.py</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_prompt</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a prompt by substituting data into a template.</span>

<span class="sd">    Args:</span>
<span class="sd">        template (str): The prompt template with placeholders.</span>
<span class="sd">        data (dict): A dictionary containing the data to substitute.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The formatted prompt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prompt</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Missing key in data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>

<p>Explanation:</p>
<p>This function takes a prompt template string and a dictionary of data. It uses the <code>format()</code> method to substitute the values from the dictionary into the placeholders in the template.  Error handling is included to catch missing keys.</p>
<h3><code>reconstructor.py</code></h3>
<p>Example function:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># reconstructor.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">def</span><span class="w"> </span><span class="nf">parse_llm_json_response</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts a JSON object from a string response, handling potential surrounding text.</span>

<span class="sd">    Args:</span>
<span class="sd">        response (str): The string containing the JSON object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The extracted JSON object as a dictionary, or None if extraction fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Use regex to find the JSON-like substring</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\{.*\}&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>  <span class="c1"># Match JSON-like structures</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">json_str</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1"># Attempt to parse the JSON string</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: No JSON object found in the response.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error decoding JSON: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An unexpected error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>

<p>Explanation:</p>
<p>This function attempts to extract a valid JSON object from a larger text string, which is a common scenario when working with LLMs. It uses regular expressions to find a JSON-like substring and then attempts to parse it using <code>json.loads()</code>. Robust error handling is included to catch invalid JSON or other unexpected errors.</p>
<h2>3. Integration into Overall Architecture</h2>
<p>These utilities serve as foundational components for interacting with and processing data from LLMs. <code>prompt.py</code> prepares the input for the LLM, while <code>reconstructor.py</code> processes the LLM's output.  <code>utils.py</code> provides general helper functions needed throughout the process, such as file I/O.</p>
<div class="codehilite"><pre><span></span><code><span class="n">graph</span><span class="w"> </span><span class="n">TD</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">User</span><span class="w"> </span><span class="n">Input</span><span class="p">]</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">Prompt</span><span class="w"> </span><span class="n">Generation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prompt</span><span class="p">.</span><span class="n">py</span><span class="p">);</span>
<span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="n">LLM</span><span class="p">);</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">Response</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Raw</span><span class="w"> </span><span class="n">Text</span><span class="p">);</span>
<span class="w">    </span><span class="n">D</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">E</span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="n">Extraction</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">reconstructor</span><span class="p">.</span><span class="n">py</span><span class="p">);</span>
<span class="w">    </span><span class="n">E</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">F</span><span class="p">{</span><span class="n">Valid</span><span class="w"> </span><span class="n">JSON</span><span class="o">?</span><span class="p">};</span>
<span class="w">    </span><span class="n">F</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">Yes</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">G</span><span class="p">(</span><span class="n">Data</span><span class="w"> </span><span class="n">Processing</span><span class="p">);</span>
<span class="w">    </span><span class="n">F</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">Error</span><span class="w"> </span><span class="n">Handling</span><span class="p">);</span>
<span class="w">    </span><span class="n">G</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">I</span><span class="p">[</span><span class="n">Output</span><span class="p">];</span>
<span class="w">    </span><span class="n">H</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">I</span><span class="p">;</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">f9f</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">f9f</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
</code></pre></div>

<h2>4. Setup and Usage Instructions</h2>
<ol>
<li><strong>Installation</strong>: Ensure you have Python installed. These files do not require any specific installation steps beyond being present in your project directory.</li>
<li><strong>Dependencies</strong>: The <code>utils.py</code> and <code>reconstructor.py</code> files depend on the <code>json</code> module, which is part of the Python standard library.  <code>reconstructor.py</code> also depends on the <code>re</code> module.</li>
<li>
<p><strong>Usage</strong>:</p>
<p>```python</p>
<h1>Example Usage</h1>
<p>from routines import utils, prompt, reconstructor</p>
<h1>Using utils.py</h1>
<p>data = utils.load_json("example.json")
if data:
    print(data)</p>
<h1>Using prompt.py</h1>
<p>template = "The capital of {} is {}."
data = {"country": "France", "capital": "Paris"}
generated_prompt = prompt.create_prompt(template, data)
if generated_prompt:
    print(generated_prompt)</p>
<h1>Using reconstructor.py</h1>
<p>llm_response = "Some text before the JSON: {\"name\": \"Example\", \"value\": 123} some text after"
extracted_data = reconstructor.parse_llm_json_response(llm_response)
if extracted_data:
    print(extracted_data)
```</p>
</li>
</ol>
<h2>5. Markdown Formatting</h2>
<p>The entire page is formatted in Markdown for easy reading and editing.</p>
<h2>6. Mermaid Diagram Explanation</h2>
<p>The Mermaid diagram above illustrates the data flow from user input to final output, highlighting the roles of <code>prompt.py</code> and <code>reconstructor.py</code> in interacting with the LLM. The diagram shows how the prompt is generated, sent to the LLM, and how the JSON response is extracted and processed.</p>
<hr />
<p><a id='page-3'></a></p>
<h2>Example Workflows and Use Cases</h2>
<h3>Related Files</h3>
<ul>
<li><code>examples/bake_bread_95423d6a-5c82-4184-8564-e58197f25a0b/metadata.json</code></li>
<li><code>examples/construct_dyson_sphere_f611aa55-0c84-4c69-979d-426194970e06/metadata.json</code></li>
<li><code>assemble.py</code></li>
</ul>
<h3>Related Pages</h3>
<p>Related topics: <a href="#page-1">Architecture Overview</a>, <a href="#page-4">Extending and Customizing Routines</a></p>
<h1>Example Workflows and Use Cases</h1>
<p>This page provides examples of how routines can be used to model and execute complex workflows. We will examine two example workflows: baking bread and constructing a Dyson sphere. We will also explore the <code>assemble.py</code> script, which is used to assemble the final wiki page content.</p>
<h2>Baking Bread Workflow</h2>
<p>This example demonstrates a relatively simple workflow for baking bread. The workflow is defined in <code>examples/bake_bread_95423d6a-5c82-4184-8564-e58197f25a0b/metadata.json</code>.</p>
<h3>Workflow Definition</h3>
<p>The <code>metadata.json</code> file contains the steps involved in baking bread. The structure includes nested steps, representing sub-processes within the overall workflow.</p>
<h3>Visualization</h3>
<div class="codehilite"><pre><span></span><code><span class="n">graph</span><span class="w"> </span><span class="n">TD</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">Gather</span><span class="w"> </span><span class="n">Ingredients</span><span class="p">]</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">Mix</span><span class="w"> </span><span class="n">Dough</span><span class="p">];</span>
<span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">First</span><span class="w"> </span><span class="n">Proofing</span><span class="p">];</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">D</span><span class="p">[</span><span class="n">Shape</span><span class="w"> </span><span class="n">Dough</span><span class="p">];</span>
<span class="w">    </span><span class="n">D</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">E</span><span class="p">[</span><span class="n">Second</span><span class="w"> </span><span class="n">Proofing</span><span class="p">];</span>
<span class="w">    </span><span class="n">E</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">F</span><span class="p">[</span><span class="n">Bake</span><span class="p">];</span>
<span class="w">    </span><span class="n">F</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">G</span><span class="p">[</span><span class="n">Cool</span><span class="p">];</span>
<span class="w">    </span><span class="n">G</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">H</span><span class="p">[</span><span class="n">Enjoy</span><span class="p">];</span>
</code></pre></div>

<h3>Code Snippets</h3>
<p>The <code>assemble.py</code> script is responsible for generating the final HTML page. The following code snippet shows how the breadcrumbs are saved.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># generate-metadata.py</span>
<span class="n">breadcrumbs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span> <span class="s2">&quot;breadcrumbs.txt&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">breadcrumbs_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">breadcrumbs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Breadcrumbs saved: </span><span class="si">{</span><span class="n">breadcrumbs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3>Explanation</h3>
<p>The breadcrumbs are generated to help the user navigate the website.</p>
<h2>Constructing a Dyson Sphere Workflow</h2>
<p>This example demonstrates a complex workflow for constructing a Dyson sphere. The workflow is defined in <code>examples/construct_dyson_sphere_f611aa55-0c84-4c69-979d-426194970e06/metadata.json</code>.</p>
<h3>Workflow Definition</h3>
<p>The <code>metadata.json</code> file contains the high-level steps involved in constructing a Dyson sphere. Due to the complexity, this workflow is broken down into several stages.</p>
<h3>Visualization</h3>
<div class="codehilite"><pre><span></span><code><span class="n">graph</span><span class="w"> </span><span class="n">TD</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">Resource</span><span class="w"> </span><span class="n">Acquisition</span><span class="p">]</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">Component</span><span class="w"> </span><span class="n">Manufacturing</span><span class="p">];</span>
<span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">Assembly</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Orbit</span><span class="p">];</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">D</span><span class="p">[</span><span class="n">Energy</span><span class="w"> </span><span class="n">Transmission</span><span class="p">];</span>
<span class="w">    </span><span class="n">D</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">E</span><span class="p">[</span><span class="n">System</span><span class="w"> </span><span class="n">Integration</span><span class="p">];</span>
</code></pre></div>

<h3>Code Snippets</h3>
<p>The <code>assemble.py</code> script is responsible for rendering the final HTML page from the JSON data.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># assemble.py</span>
<span class="n">output_html</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

<span class="c1"># Write output</span>
<span class="c1"># Generate slug from processed metadata title</span>
<span class="n">slug</span> <span class="o">=</span> <span class="n">processed_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="n">processed_metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">))</span>
<span class="c1"># Ensure slug is filesystem-safe (basic example)</span>
<span class="n">slug</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">slug</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="ow">or</span> <span class="s2">&quot;output&quot;</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">slug</span><span class="si">}</span><span class="s2">.html&quot;</span>
<span class="n">output_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_html</span><span class="p">)</span>
</code></pre></div>

<h3>Explanation</h3>
<p>The <code>assemble.py</code> script uses Jinja2 templates to generate the final HTML output. It takes the metadata, specifications, and alternatives as input, and renders them into a complete HTML page.</p>
<h2><code>assemble.py</code> Script</h2>
<p>The <code>assemble.py</code> script is the final step in the workflow. It takes the output from the previous steps and assembles them into a single HTML page.</p>
<h3>Functionality</h3>
<p>The <code>assemble.py</code> script performs the following functions:</p>
<ol>
<li>Loads the metadata, specifications, and alternatives from JSON files.</li>
<li>Processes the metadata, including adding contributors, dates, and breadcrumbs.</li>
<li>Renders the data into an HTML template using Jinja2.</li>
<li>Writes the HTML output to a file.</li>
</ol>
<h3>Architecture</h3>
<p>The <code>assemble.py</code> script fits into the overall architecture as the final stage in the content generation pipeline. It takes the processed data from the previous stages and generates the final output.</p>
<h3>Usage Instructions</h3>
<p>To use the <code>assemble.py</code> script, you need to provide the input directory containing the JSON files.</p>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>assemble.py<span class="w"> </span>&lt;input_directory&gt;<span class="w"> </span>&lt;output_directory&gt;
</code></pre></div>

<h3>Code Snippets</h3>
<p>The following code snippet shows how the <code>assemble.py</code> script loads the JSON data.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># assemble.py</span>
<span class="n">metadata_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span> <span class="s2">&quot;metadata.json&quot;</span><span class="p">)</span>
<span class="n">specs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span> <span class="s2">&quot;specifications-industrial.json&quot;</span><span class="p">)</span>
<span class="n">alt_trees_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span> <span class="s2">&quot;hallucinate-tree.json&quot;</span><span class="p">)</span>

<span class="n">metadata_data</span> <span class="o">=</span> <span class="n">load_json</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">)</span>
<span class="n">specs_data</span> <span class="o">=</span> <span class="n">load_json</span><span class="p">(</span><span class="n">specs_path</span><span class="p">)</span>
<span class="n">alt_trees_data</span> <span class="o">=</span> <span class="n">load_json</span><span class="p">(</span><span class="n">alt_trees_path</span><span class="p">)</span>
</code></pre></div>

<h3>Component Relationships</h3>
<div class="codehilite"><pre><span></span><code><span class="n">graph</span><span class="w"> </span><span class="n">TD</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span><span class="p">]</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">hallucinate</span><span class="o">-</span><span class="n">tree</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">generate</span><span class="o">-</span><span class="n">automation</span><span class="o">-</span><span class="n">timeline</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">D</span><span class="p">[</span><span class="n">generate</span><span class="o">-</span><span class="n">automation</span><span class="o">-</span><span class="n">challenges</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="w">    </span><span class="n">D</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">E</span><span class="p">[</span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="w">    </span><span class="n">E</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">F</span><span class="p">[</span><span class="n">current</span><span class="o">-</span><span class="n">implementations</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="w">    </span><span class="n">F</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">G</span><span class="p">[</span><span class="k">return</span><span class="o">-</span><span class="n">analysis</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="w">    </span><span class="n">G</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">H</span><span class="p">[</span><span class="n">future</span><span class="o">-</span><span class="n">technology</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="w">    </span><span class="n">H</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">I</span><span class="p">[</span><span class="n">specifications</span><span class="o">-</span><span class="n">industrial</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>
<span class="w">    </span><span class="n">I</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">J</span><span class="p">[</span><span class="n">assemble</span><span class="o">.</span><span class="n">py</span><span class="p">];</span>


<span class="o">---</span>

<span class="o">&lt;</span><span class="n">a</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s1">&#39;page-4&#39;</span><span class="o">&gt;&lt;/</span><span class="n">a</span><span class="o">&gt;</span>

<span class="c1">## Extending and Customizing Routines</span>

<span class="c1">### Related Files</span>

<span class="o">-</span><span class="w"> </span><span class="err">`</span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span><span class="err">`</span>
<span class="o">-</span><span class="w"> </span><span class="err">`</span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span><span class="err">`</span>
<span class="o">-</span><span class="w"> </span><span class="err">`</span><span class="n">README</span><span class="o">.</span><span class="n">md</span><span class="err">`</span>

<span class="c1">### Related Pages</span>

<span class="n">Related</span><span class="w"> </span><span class="n">topics</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">Example</span><span class="w"> </span><span class="n">Workflows</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">Cases</span><span class="p">](</span><span class="c1">#page-3)</span>

<span class="c1">## Extending and Customizing Routines</span>

<span class="n">This</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">extend</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">customize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">routines</span><span class="err">`</span><span class="w"> </span><span class="n">repository</span><span class="p">,</span><span class="w"> </span><span class="n">focusing</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="err">`</span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="err">`</span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="err">`</span><span class="n">README</span><span class="o">.</span><span class="n">md</span><span class="err">`</span><span class="o">.</span>

<span class="c1">### Purpose and Functionality</span>

<span class="n">The</span><span class="w"> </span><span class="err">`</span><span class="n">routines</span><span class="err">`</span><span class="w"> </span><span class="n">repository</span><span class="w"> </span><span class="n">appears</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">automated</span><span class="w"> </span><span class="n">generation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">documentation</span><span class="p">,</span><span class="w"> </span><span class="n">specifically</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">creating</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="s2">&quot;Universal Automation Wiki.&quot;</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">series</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Python</span><span class="w"> </span><span class="n">scripts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">LLMs</span><span class="w"> </span><span class="p">(</span><span class="n">Language</span><span class="w"> </span><span class="n">Model</span><span class="p">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="n">assemble</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">structured</span><span class="w"> </span><span class="n">document</span><span class="o">.</span>

<span class="o">-</span><span class="w">   </span><span class="o">**</span><span class="err">`</span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">seems</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">orchestrate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">overall</span><span class="w"> </span><span class="n">workflow</span><span class="o">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">defines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="p">,</span><span class="w"> </span><span class="n">manages</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">paths</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">handles</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">step</span><span class="o">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">manages</span><span class="w"> </span><span class="n">breadcrumbs</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">navigation</span><span class="o">.</span>
<span class="o">-</span><span class="w">   </span><span class="o">**</span><span class="err">`</span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">generates</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">topic</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">LLM</span><span class="o">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">topic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">constructs</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">prompt</span><span class="p">,</span><span class="w"> </span><span class="n">sends</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">LLM</span><span class="p">,</span><span class="w"> </span><span class="n">parses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">metadata</span><span class="o">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="n">automation</span><span class="w"> </span><span class="n">progress</span><span class="p">,</span><span class="w"> </span><span class="n">explanatory</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">summary</span><span class="o">.</span>
<span class="o">-</span><span class="w">   </span><span class="o">**</span><span class="err">`</span><span class="n">README</span><span class="o">.</span><span class="n">md</span><span class="err">`</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">repository</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">instructions</span><span class="p">,</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">examples</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">project</span><span class="s1">&#39;s goals.</span>

<span class="c1">### Code Examples and Explanations</span>

<span class="c1">#### `flow-maker.py`</span>

<span class="n">This</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">orchestrator</span><span class="o">.</span><span class="w">  </span><span class="n">Here</span><span class="s1">&#39;s a snippet highlighting the program execution flow:</span>

<span class="err">```</span><span class="n">python</span>
<span class="c1"># flow-maker.py</span>
<span class="n">import</span><span class="w"> </span><span class="n">os</span>
<span class="n">import</span><span class="w"> </span><span class="n">sys</span>
<span class="n">import</span><span class="w"> </span><span class="n">json</span>
<span class="n">import</span><span class="w"> </span><span class="n">uuid</span>
<span class="n">import</span><span class="w"> </span><span class="n">shutil</span>
<span class="n">from</span><span class="w"> </span><span class="n">datetime</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">datetime</span>
<span class="n">import</span><span class="w"> </span><span class="n">subprocess</span>
<span class="n">from</span><span class="w"> </span><span class="n">utils</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">load_json</span><span class="p">,</span><span class="w"> </span><span class="n">saveToFile</span><span class="p">,</span><span class="w"> </span><span class="n">parse_llm_json_response</span><span class="p">,</span><span class="w"> </span><span class="n">chat_with_llm</span><span class="p">,</span><span class="w"> </span><span class="n">handle_command_args</span><span class="p">,</span><span class="w"> </span><span class="n">get_output_filepath</span>

<span class="n">def</span><span class="w"> </span><span class="n">main</span><span class="p">():</span>
<span class="w">    </span><span class="n">usage_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Usage: python flow-maker.py &lt;input_json&gt; [flow_dir] [-uuid=</span><span class="se">\&quot;</span><span class="s2">UUID</span><span class="se">\&quot;</span><span class="s2">] [-force] [-saveInputs] [-model=</span><span class="se">\&quot;</span><span class="s2">MODEL</span><span class="se">\&quot;</span><span class="s2">]&quot;</span>
<span class="w">    </span><span class="n">input_filepath</span><span class="p">,</span><span class="w"> </span><span class="n">flow_dir</span><span class="p">,</span><span class="w"> </span><span class="n">custom_uuid</span><span class="p">,</span><span class="w"> </span><span class="n">force_overwrite</span><span class="p">,</span><span class="w"> </span><span class="n">save_inputs</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">handle_command_args</span><span class="p">(</span><span class="n">usage_msg</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">flow_dir</span><span class="p">:</span>
<span class="w">        </span><span class="n">flow_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;flow&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">custom_uuid</span><span class="p">:</span>
<span class="w">        </span><span class="n">flow_uuid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">custom_uuid</span>
<span class="w">    </span><span class="k">else</span><span class="p">:</span>
<span class="w">        </span><span class="n">flow_uuid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>

<span class="w">    </span><span class="n">flowUUID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flow_uuid</span><span class="w"> </span><span class="c1"># Set the global variable</span>
<span class="w">    </span><span class="n">flow_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span><span class="w"> </span><span class="n">flowUUID</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">):</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">force_overwrite</span><span class="p">:</span>
<span class="w">            </span><span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span><span class="p">:</span>
<span class="w">            </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Error: Flow directory &#39;{flow_dir}&#39; already exists. Use -force to overwrite.&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="w">    </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
<span class="w">    </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;inputs&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">exist_ok</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Copy input file to flow directory</span>
<span class="w">    </span><span class="n">input_copy_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;input.json&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">input_filepath</span><span class="p">,</span><span class="w"> </span><span class="n">input_copy_path</span><span class="p">)</span>
<span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Copied input file to: {input_copy_path}&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Create breadcrumbs file</span>
<span class="w">    </span><span class="n">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">load_json</span><span class="p">(</span><span class="n">input_filepath</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;topic&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Unknown Topic&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">breadcrumbs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;Home &gt; {topic}&quot;</span>
<span class="w">    </span><span class="n">breadcrumbs_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;breadcrumbs.txt&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">breadcrumbs_path</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;w&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>
<span class="w">        </span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">breadcrumbs</span><span class="p">)</span>
<span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Breadcrumbs saved: {breadcrumbs}&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Define the programs to run in order</span>
<span class="w">    </span><span class="n">programs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;generate-metadata.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;1.json&quot;</span><span class="p">),</span><span class="w">  </span><span class="c1"># 1. metadata.py</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;hallucinate-tree.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;2.json&quot;</span><span class="p">),</span><span class="w">   </span><span class="c1"># 2. hallucinate-tree.py</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;generate-automation-timeline.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;3.json&quot;</span><span class="p">),</span><span class="w">  </span><span class="c1"># 3. generate-automation-timeline.py</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;generate-automation-challenges.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;4.json&quot;</span><span class="p">),</span><span class="w"> </span><span class="c1"># 4. generate-automation-challenges.py</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;automation-adoption.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;5.json&quot;</span><span class="p">),</span><span class="w">  </span><span class="c1"># 5. automation-adoption.py</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;current-implementations.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;6.json&quot;</span><span class="p">),</span><span class="w">  </span><span class="c1"># 6. current-implementations.py</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;return-analysis.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;7.json&quot;</span><span class="p">),</span><span class="w">  </span><span class="c1"># 7. return-analysis.py</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;future-technology.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;8.json&quot;</span><span class="p">),</span><span class="w">  </span><span class="c1"># 8. future-technology.py</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;specifications-industrial.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;9.json&quot;</span><span class="p">),</span><span class="w">  </span><span class="c1"># 9. specifications-industrial.py</span>
<span class="w">        </span><span class="p">(</span><span class="s2">&quot;assemble.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">None</span><span class="p">),</span><span class="w">  </span><span class="c1"># 10. assemble.py - Output filename handled differently</span>
<span class="w">    </span><span class="p">]</span>

<span class="w">    </span><span class="c1"># Run each program in sequence</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">program</span><span class="p">,</span><span class="w"> </span><span class="n">output_filename</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">programs</span><span class="p">):</span>
<span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Step {i+1}/{len(programs)}: Running {program}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="c1"># Default input is the copied input.json</span>
<span class="w">        </span><span class="n">current_input_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_copy_path</span>

<span class="w">        </span><span class="c1"># Define output path for this program</span>
<span class="w">        </span><span class="c1"># For assemble.py, the output path is the flow directory itself</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;assemble.py&quot;</span><span class="p">:</span>
<span class="w">            </span><span class="n">output_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flow_dir</span>
<span class="w">            </span><span class="n">current_input_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flow_dir</span><span class="w"> </span><span class="c1"># assemble.py takes the flow dir as input now</span>
<span class="w">        </span><span class="k">else</span><span class="p">:</span>
<span class="w">            </span><span class="n">output_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flow_dir</span><span class="p">,</span><span class="w"> </span><span class="n">output_filename</span><span class="p">)</span>

<span class="w">        </span><span class="c1"># Construct command</span>
<span class="w">        </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span>
<span class="w">            </span><span class="n">program</span><span class="p">,</span>
<span class="w">            </span><span class="n">current_input_path</span><span class="p">,</span>
<span class="w">            </span><span class="n">output_path</span><span class="p">,</span>
<span class="w">            </span><span class="n">f</span><span class="s2">&quot;-uuid={flow_uuid}&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">f</span><span class="s2">&quot;-flow_uuid={flowUUID}&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">save_inputs</span><span class="p">:</span>
<span class="w">            </span><span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-saveInputs&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">model</span><span class="p">:</span>
<span class="w">            </span><span class="n">command</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;-model={model}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="c1"># Execute command</span>
<span class="w">        </span><span class="n">try</span><span class="p">:</span>
<span class="w">            </span><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">check</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
<span class="w">            </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Successfully executed {program}&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">except</span><span class="w"> </span><span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">e</span><span class="p">:</span>
<span class="w">            </span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Error executing {program}: {e}&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Flow execution completed.&quot;</span><span class="p">)</span>

<span class="k">if</span><span class="w"> </span><span class="n">__name__</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="n">main</span><span class="p">()</span>
</code></pre></div>

<p>Explanation:</p>
<ol>
<li><strong>Argument Parsing</strong>: The script starts by parsing command-line arguments using <code>handle_command_args</code>. This function likely handles options for specifying the input JSON file, output directory, UUID, and whether to force overwrite existing directories.</li>
<li><strong>Directory Setup</strong>: It creates the necessary directory structure for the flow, including a directory for input files.</li>
<li><strong>Input Copying</strong>: It copies the input JSON file to the flow directory for subsequent steps to use.</li>
<li><strong>Program Execution</strong>: The script defines a list of programs (<code>generate-metadata.py</code>, <code>hallucinate-tree.py</code>, etc.) to be executed in sequence.  For each program, it constructs a command-line command and executes it using <code>subprocess.run</code>. The output of each program is saved to a file in the flow directory.</li>
<li><strong>Error Handling</strong>: The script includes error handling to catch exceptions during program execution and exit with an error message if any step fails.</li>
</ol>
<h4><code>generate-metadata.py</code></h4>
<p>This script generates the initial metadata for the wiki page.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># generate-metadata.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_json</span><span class="p">,</span> <span class="n">saveToFile</span><span class="p">,</span> <span class="n">parse_llm_json_response</span><span class="p">,</span> <span class="n">chat_with_llm</span><span class="p">,</span> <span class="n">handle_command_args</span><span class="p">,</span> <span class="n">get_output_filepath</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_page_metadata</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">save_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-4&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates metadata for a Universal Automation Wiki page using an LLM.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">flowUUID</span>
    <span class="n">topic</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;topic&quot;</span><span class="p">,</span> <span class="s2">&quot;Default Topic&quot;</span><span class="p">)</span>

    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
        <span class="s2">&quot;top_p&quot;</span><span class="p">:</span> <span class="mf">0.9</span>
    <span class="p">}</span>

    <span class="n">systemMsg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;You are an expert content creator for a Universal Automation Wiki. &quot;</span>
        <span class="s2">&quot;Your task is to generate concise and informative metadata for a given topic. &quot;</span>
        <span class="s2">&quot;The metadata should include the following fields:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;- Title (1-2 sentences)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;- Summary (2-3 sentences)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;- Keywords (5-10 relevant keywords)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;- automation_progress: progress toward full automation (as a percentage). BE CRITICAL, do not exaggerate current status. E.g., &#39;25%&#39; would be appropriate for topics where some partial automation is POSSIBLE.&quot;</span>
        <span class="s2">&quot;- Explanatory text (2-3 FULL paragraphs) that describes the topic and its automation journey.&quot;</span>
        <span class="s2">&quot;Format your response as a JSON object with these fields.&quot;</span>
    <span class="p">)</span>

    <span class="n">user_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Create metadata for a Universal Automation Wiki page about: </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Save inputs to file if requested</span>
    <span class="k">if</span> <span class="n">save_inputs</span><span class="p">:</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;flow/</span><span class="si">{</span><span class="n">flowUUID</span><span class="si">}</span><span class="s2">/inputs/1-in.json&quot;</span>
        <span class="n">saveToFile</span><span class="p">(</span><span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">save_path</span><span class="p">)</span>

    <span class="c1"># Use chat_with_llm to generate metadata</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat_with_llm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
    <span class="c1"># Parse JSON using shared utility to extract JSON block reliably</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">parse_llm_json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Parsed metadata is not a JSON object. Full response: &quot;</span> <span class="o">+</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">metadata</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main function to run the metadata generation.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">flowUUID</span>
    <span class="n">usage_msg</span> <span class="o">=</span> <span class="s2">&quot;Usage: python generate-metadata.py &lt;input_json&gt; [output_json] [-saveInputs] [-uuid=</span><span class="se">\&quot;</span><span class="s2">UUID</span><span class="se">\&quot;</span><span class="s2">] [-flow_uuid=</span><span class="se">\&quot;</span><span class="s2">FLOW-UUID</span><span class="se">\&quot;</span><span class="s2">]&quot;</span>
    <span class="n">input_filepath</span><span class="p">,</span> <span class="n">specified_output_filepath</span><span class="p">,</span> <span class="n">save_inputs</span><span class="p">,</span> <span class="n">custom_uuid</span><span class="p">,</span> <span class="n">flow_uuid_arg</span> <span class="o">=</span> <span class="n">handle_command_args</span><span class="p">(</span><span class="n">usage_msg</span><span class="p">)</span>
    <span class="n">flowUUID</span> <span class="o">=</span> <span class="n">flow_uuid_arg</span> <span class="c1"># Set the global variable</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Working...&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

    <span class="n">input_data</span> <span class="o">=</span> <span class="n">load_json</span><span class="p">(</span><span class="n">input_filepath</span><span class="p">)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">generate_page_metadata</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">save_inputs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to generate metadata.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Get output filepath and UUID</span>
    <span class="n">output_filepath</span><span class="p">,</span> <span class="n">output_uuid</span> <span class="o">=</span> <span class="n">get_output_filepath</span><span class="p">(</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> 
        <span class="n">specified_output_filepath</span><span class="p">,</span> 
        <span class="n">input_filepath</span><span class="p">,</span> 
        <span class="n">flowUUID</span>
    <span class="p">)</span>

    <span class="c1"># Save the updated metadata to the output file</span>
    <span class="n">saveToFile</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">filepath</span><span class="o">=</span><span class="n">output_filepath</span><span class="p">)</span>

    <span class="n">end_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finished. Took </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

<p>Explanation:</p>
<ol>
<li><strong>LLM Interaction</strong>: The core of the script is the <code>generate_page_metadata</code> function. It constructs a system message and a user message to prompt the LLM to generate metadata for a given topic.</li>
<li><strong>Prompt Engineering</strong>: The system message defines the role of the LLM and the required format of the output (a JSON object with specific fields). The user message provides the specific topic for which metadata should be generated.</li>
<li><strong>JSON Parsing</strong>: The script uses <code>parse_llm_json_response</code> to reliably extract the JSON block from the LLM's response.</li>
<li><strong>Error Handling</strong>: It checks if the parsed metadata is a valid JSON object and handles potential errors.</li>
</ol>
<h4><code>README.md</code></h4>
<p>The <code>README.md</code> file contains setup and usage instructions.  A typical <code>README.md</code> would include sections on:</p>
<ul>
<li><strong>Installation</strong>: Instructions on how to install the necessary dependencies (e.g., Python packages).</li>
<li><strong>Usage</strong>: Examples of how to run the scripts, including command-line arguments.</li>
<li><strong>Configuration</strong>: Information on how to configure the LLM (e.g., API keys, model selection).</li>
<li><strong>Customization</strong>: Guidance on how to extend or modify the scripts to suit specific needs.</li>
</ul>
<h3>Overall Architecture</h3>
<p>The <code>routines</code> repository uses a modular architecture, where each Python script performs a specific task in the overall documentation generation pipeline. The <code>flow-maker.py</code> script acts as the central orchestrator, coordinating the execution of the other scripts.  Data is passed between scripts using JSON files.</p>
<div class="codehilite"><pre><span></span><code><span class="nx">graph</span><span class="w"> </span><span class="nx">TD</span>
<span class="w">    </span><span class="nx">A</span><span class="p">[</span><span class="nx">input</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">B</span><span class="p">(</span><span class="nx">flow</span><span class="o">-</span><span class="nx">maker</span><span class="p">.</span><span class="nx">py</span><span class="p">)</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">C</span><span class="p">{</span><span class="nx">generate</span><span class="o">-</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">C</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">D</span><span class="p">[</span><span class="mi">1</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">E</span><span class="p">{</span><span class="nx">hallucinate</span><span class="o">-</span><span class="nx">tree</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">E</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">F</span><span class="p">[</span><span class="mi">2</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">G</span><span class="p">{</span><span class="nx">generate</span><span class="o">-</span><span class="nx">automation</span><span class="o">-</span><span class="nx">timeline</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">G</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">H</span><span class="p">[</span><span class="mi">3</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">I</span><span class="p">{</span><span class="nx">generate</span><span class="o">-</span><span class="nx">automation</span><span class="o">-</span><span class="nx">challenges</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">I</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">J</span><span class="p">[</span><span class="mi">4</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">K</span><span class="p">{</span><span class="nx">automation</span><span class="o">-</span><span class="nx">adoption</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">K</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">L</span><span class="p">[</span><span class="mi">5</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">M</span><span class="p">{</span><span class="nx">current</span><span class="o">-</span><span class="nx">implementations</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">M</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">N</span><span class="p">[</span><span class="mi">6</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">O</span><span class="p">{</span><span class="k">return</span><span class="o">-</span><span class="nx">analysis</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">O</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">P</span><span class="p">[</span><span class="mi">7</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">Q</span><span class="p">{</span><span class="nx">future</span><span class="o">-</span><span class="nx">technology</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Q</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">R</span><span class="p">[</span><span class="mi">8</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">S</span><span class="p">{</span><span class="nx">specifications</span><span class="o">-</span><span class="nx">industrial</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">S</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">T</span><span class="p">[</span><span class="mi">9</span><span class="p">.</span><span class="nx">json</span><span class="p">]</span>
<span class="w">    </span><span class="nx">B</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">U</span><span class="p">{</span><span class="nx">assemble</span><span class="p">.</span><span class="nx">py</span><span class="p">}</span>
<span class="w">    </span><span class="nx">U</span><span class="w"> </span><span class="o">--</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">V</span><span class="p">[</span><span class="nx">Output</span><span class="w"> </span><span class="nx">Wiki</span><span class="w"> </span><span class="nx">Pages</span><span class="p">]</span>
<span class="w">    </span><span class="nx">style</span><span class="w"> </span><span class="nx">B</span><span class="w"> </span><span class="nx">fill</span><span class="p">:</span><span class="err">#</span><span class="nx">f9f</span><span class="p">,</span><span class="nx">stroke</span><span class="p">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="nx">stroke</span><span class="o">-</span><span class="nx">width</span><span class="p">:</span><span class="mi">2</span><span class="nx">px</span>
</code></pre></div>

<h3>Setup and Usage Instructions</h3>
<ol>
<li>
<p><strong>Clone the repository:</strong></p>
<p><code>bash
git clone https://github.com/jamiem0/routines.git
cd routines</code>
2.  <strong>Install dependencies:</strong></p>
<p><code>bash
pip install -r requirements.txt</code></p>
<p>(The <code>README.md</code> should list all dependencies in a <code>requirements.txt</code> file.)
3.  <strong>Configure LLM:</strong> Set up the necessary environment variables or configuration files for accessing the LLM. This typically involves providing an API key.
4.  <strong>Run <code>flow-maker.py</code>:</strong></p>
<p><code>bash
python flow-maker.py &lt;input_json&gt; [flow_dir] [-uuid="UUID"] [-force] [-saveInputs] [-model="MODEL"]</code></p>
<ul>
<li><code>&lt;input_json&gt;</code>: Path to the input JSON file containing the topic for which to generate documentation.</li>
<li><code>[flow_dir]</code>: Optional directory to store the generated files. If not specified, a directory will be created automatically.</li>
<li><code>[-uuid="UUID"]</code>: Optional UUID for the flow.</li>
<li><code>[-force]</code>: Optional flag to force overwrite an existing flow directory.</li>
<li><code>[-saveInputs]</code>: Optional flag to save the inputs to each script.</li>
<li><code>[-model="MODEL"]</code>: Optional LLM model to use (e.g., "gpt-4").</li>
</ul>
</li>
</ol>
<h3>Extending and Customizing</h3>
<p>To extend and customize the <code>routines</code> repository, you can modify the existing scripts or add new ones. Here are some potential areas for customization:</p>
<ul>
<li><strong>Adding new steps to the workflow:</strong> Modify <code>flow-maker.py</code> to include additional scripts in the execution sequence.</li>
<li><strong>Customizing the LLM prompts:</strong> Modify the system and user messages in <code>generate-metadata.py</code> and other scripts to generate different types of content.</li>
<li><strong>Adding new metadata fields:</strong> Modify <code>generate-metadata.py</code> to include additional fields in the generated metadata.</li>
<li><strong>Implementing different output formats:</strong> Modify <code>assemble.py</code> to generate documentation in different formats (e.g., HTML, PDF).</li>
<li><strong>Integrating with other tools:</strong> Integrate the <code>routines</code> repository with other tools, such as content management systems or documentation platforms.</li>
</ul>
<h3>Example: Adding a new metadata field</h3>
<p>To add a new metadata field, such as "Difficulty Level", to the generated metadata, you would need to modify <code>generate-metadata.py</code>.</p>
<ol>
<li>
<p><strong>Modify the system message:</strong></p>
<p><code>python
systemMsg = (
    "You are an expert content creator for a Universal Automation Wiki. "
    "Your task is to generate concise and informative metadata for a given topic. "
    "The metadata should include the following fields:\n"
    "- Title (1-2 sentences)\n"
    "- Summary (2-3 sentences)\n"
    "- Keywords (5-10 relevant keywords)\n"
    "- Difficulty Level (Easy, Medium, or Hard)\n" # ADDED
    "- automation_progress: progress toward full automation (as a percentage). BE CRITICAL, do not exaggerate current status. E.g., '25%' would be appropriate for topics where some partial automation is POSSIBLE."
    "- Explanatory text (2-3 FULL paragraphs) that describes the topic and its automation journey."
    "Format your response as a JSON object with these fields."
)</code></p>
</li>
<li>
<p><strong>Ensure the parsing and saving mechanisms handle the new field.</strong> The <code>parse_llm_json_response</code> utility should automatically handle the new field if it's present in the LLM's response. The <code>saveToFile</code> function will also save the new field to the output JSON file.</p>
</li>
</ol>
<h3>Component Relationships</h3>
<div class="codehilite"><pre><span></span><code><span class="n">graph</span><span class="w"> </span><span class="n">TD</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">Input</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">Metadata</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">D</span><span class="p">(</span><span class="n">hallucinate</span><span class="o">-</span><span class="n">tree</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">D</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">E</span><span class="p">[</span><span class="n">Outline</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span>
<span class="w">    </span><span class="n">E</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">F</span><span class="p">(</span><span class="n">generate</span><span class="o">-</span><span class="n">automation</span><span class="o">-</span><span class="n">timeline</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">F</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">G</span><span class="p">[</span><span class="n">Timeline</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span>
<span class="w">    </span><span class="n">G</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">H</span><span class="p">(</span><span class="n">generate</span><span class="o">-</span><span class="n">automation</span><span class="o">-</span><span class="n">challenges</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">H</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">I</span><span class="p">[</span><span class="n">Challenges</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span>
<span class="w">    </span><span class="n">I</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">J</span><span class="p">(</span><span class="n">automation</span><span class="o">-</span><span class="n">adoption</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">J</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">K</span><span class="p">[</span><span class="n">Adoption</span><span class="w"> </span><span class="n">Phases</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span>
<span class="w">    </span><span class="n">K</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">L</span><span class="p">(</span><span class="n">current</span><span class="o">-</span><span class="n">implementations</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">L</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">M</span><span class="p">[</span><span class="n">Implementations</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span>
<span class="w">    </span><span class="n">M</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">N</span><span class="p">(</span><span class="k">return</span><span class="o">-</span><span class="n">analysis</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">N</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">O</span><span class="p">[</span><span class="n">Return</span><span class="w"> </span><span class="n">Analysis</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span>
<span class="w">    </span><span class="n">O</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">P</span><span class="p">(</span><span class="n">future</span><span class="o">-</span><span class="n">technology</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">P</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">Q</span><span class="p">[</span><span class="n">Future</span><span class="w"> </span><span class="n">Tech</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span>
<span class="w">    </span><span class="n">Q</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">R</span><span class="p">(</span><span class="n">specifications</span><span class="o">-</span><span class="n">industrial</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">R</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">S</span><span class="p">[</span><span class="n">Specifications</span><span class="w"> </span><span class="n">JSON</span><span class="p">]</span>
<span class="w">    </span><span class="n">S</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">assemble</span><span class="p">.</span><span class="n">py</span><span class="p">)</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">U</span><span class="p">[</span><span class="n">Output</span><span class="w"> </span><span class="n">Wiki</span><span class="w"> </span><span class="n">Pages</span><span class="p">]</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">T</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">ccf</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
</code></pre></div>

<h3>Data Flow</h3>
<div class="codehilite"><pre><span></span><code><span class="n">sequenceDiagram</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">User</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">LLM</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">assemble</span><span class="o">.</span><span class="n">py</span>

<span class="w">    </span><span class="n">User</span><span class="o">-&gt;&gt;</span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="n">json</span>
<span class="w">    </span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="w"> </span><span class="n">Execute</span><span class="w"> </span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="w">    </span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">LLM</span><span class="p">:</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">generation</span>
<span class="w">    </span><span class="n">LLM</span><span class="o">-&gt;&gt;</span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="w"> </span><span class="n">Return</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="n">format</span>
<span class="w">    </span><span class="n">generate</span><span class="o">-</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="w"> </span><span class="n">Save</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">1.j</span><span class="n">son</span>
<span class="w">    </span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">assemble</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="w"> </span><span class="n">Execute</span><span class="w"> </span><span class="n">assemble</span><span class="o">.</span><span class="n">py</span>
<span class="w">    </span><span class="n">assemble</span><span class="o">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">flow</span><span class="o">-</span><span class="n">maker</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="w"> </span><span class="n">Read</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="n">files</span>
<span class="w">    </span><span class="n">assemble</span><span class="o">.</span><span class="n">py</span><span class="o">-&gt;&gt;</span><span class="n">User</span><span class="p">:</span><span class="w"> </span><span class="n">Generate</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="n">wiki</span><span class="w"> </span><span class="n">pages</span>


<span class="o">---</span>

<span class="o">&lt;</span><span class="n">a</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s1">&#39;page-5&#39;</span><span class="o">&gt;&lt;/</span><span class="n">a</span><span class="o">&gt;</span>

<span class="c1">## Natural Language Processing and Simplification</span>

<span class="c1">### Related Files</span>

<span class="o">-</span><span class="w"> </span><span class="err">`</span><span class="n">simplified</span><span class="o">-</span><span class="n">technical</span><span class="o">-</span><span class="n">english</span><span class="o">.</span><span class="n">py</span><span class="err">`</span>
<span class="o">-</span><span class="w"> </span><span class="err">`</span><span class="n">basic</span><span class="o">-</span><span class="n">english</span><span class="o">.</span><span class="n">py</span><span class="err">`</span>
<span class="o">-</span><span class="w"> </span><span class="err">`</span><span class="n">examples</span><span class="o">/</span><span class="n">simplified</span><span class="o">-</span><span class="n">technical</span><span class="o">-</span><span class="n">english</span><span class="o">-</span><span class="ow">in</span><span class="o">.</span><span class="n">json</span><span class="err">`</span>
<span class="o">-</span><span class="w"> </span><span class="err">`</span><span class="n">examples</span><span class="o">/</span><span class="n">basic</span><span class="o">-</span><span class="n">english</span><span class="o">-</span><span class="ow">in</span><span class="o">.</span><span class="n">json</span><span class="err">`</span>

<span class="c1"># Natural Language Processing and Simplification</span>

<span class="n">This</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">natural</span><span class="w"> </span><span class="n">language</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">simplification</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">routines</span><span class="err">`</span><span class="w"> </span><span class="n">repository</span><span class="p">,</span><span class="w"> </span><span class="n">focusing</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="err">`</span><span class="n">simplified</span><span class="o">-</span><span class="n">technical</span><span class="o">-</span><span class="n">english</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">`</span><span class="n">basic</span><span class="o">-</span><span class="n">english</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="o">.</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">aim</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nb">convert</span><span class="w"> </span><span class="n">complex</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">accessible</span><span class="w"> </span><span class="n">formats</span><span class="o">.</span>

<span class="c1">## Purpose and Functionality</span>

<span class="n">The</span><span class="w"> </span><span class="n">primary</span><span class="w"> </span><span class="n">goal</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">simplify</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">making</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">easier</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">understand</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">broader</span><span class="w"> </span><span class="n">audience</span><span class="o">.</span><span class="w">  </span><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">achieved</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">approaches</span><span class="p">:</span>

<span class="mf">1.</span><span class="w">  </span><span class="o">**</span><span class="n">Simplified</span><span class="w"> </span><span class="n">Technical</span><span class="w"> </span><span class="n">English</span><span class="w"> </span><span class="p">(</span><span class="n">STE</span><span class="p">):</span><span class="o">**</span><span class="w">  </span><span class="n">Transforms</span><span class="w"> </span><span class="n">technical</span><span class="w"> </span><span class="n">documentation</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">controlled</span><span class="w"> </span><span class="n">language</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">specific</span><span class="w"> </span><span class="n">rules</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">vocabulary</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">grammar</span><span class="o">.</span><span class="w">  </span><span class="n">This</span><span class="w"> </span><span class="n">enhances</span><span class="w"> </span><span class="n">clarity</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reduces</span><span class="w"> </span><span class="n">ambiguity</span><span class="o">.</span>
<span class="mf">2.</span><span class="w">  </span><span class="o">**</span><span class="n">Basic</span><span class="w"> </span><span class="n">English</span><span class="p">:</span><span class="o">**</span><span class="w"> </span><span class="n">Converts</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">English</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">vocabulary</span><span class="p">,</span><span class="w"> </span><span class="n">suitable</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">language</span><span class="w"> </span><span class="n">learners</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">situations</span><span class="w"> </span><span class="n">requiring</span><span class="w"> </span><span class="n">utmost</span><span class="w"> </span><span class="n">simplicity</span><span class="o">.</span>

<span class="c1">## File Breakdown</span>

<span class="o">*</span><span class="w">   </span><span class="o">**</span><span class="err">`</span><span class="n">simplified</span><span class="o">-</span><span class="n">technical</span><span class="o">-</span><span class="n">english</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="p">:</span><span class="o">**</span><span class="w"> </span><span class="n">Contains</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">generate_page_metadata</span><span class="err">`</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">`</span><span class="n">adoption_phases</span><span class="err">`</span><span class="w"> </span><span class="n">functions</span><span class="o">.</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">language</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="p">(</span><span class="n">LLM</span><span class="p">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Universal</span><span class="w"> </span><span class="n">Automation</span><span class="w"> </span><span class="n">Wiki</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">generate</span><span class="w"> </span><span class="n">automation</span><span class="w"> </span><span class="n">adoption</span><span class="w"> </span><span class="n">phases</span><span class="o">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">topic</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">percentage</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">automation</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">explanatory</span><span class="w"> </span><span class="n">text</span><span class="o">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="err">`</span><span class="n">chat_with_llm</span><span class="err">`</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">interact</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">LLM</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">`</span><span class="n">parse_llm_json_response</span><span class="err">`</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">parse</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">LLM</span><span class="s1">&#39;s JSON response.</span>
<span class="o">*</span><span class="w">   </span><span class="o">**</span><span class="err">`</span><span class="n">basic</span><span class="o">-</span><span class="n">english</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="p">:</span><span class="o">**</span><span class="w"> </span><span class="n">Currently</span><span class="p">,</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">functionality</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="n">provided</span><span class="o">.</span>
<span class="o">*</span><span class="w">   </span><span class="o">**</span><span class="err">`</span><span class="n">examples</span><span class="o">/</span><span class="n">simplified</span><span class="o">-</span><span class="n">technical</span><span class="o">-</span><span class="n">english</span><span class="o">-</span><span class="ow">in</span><span class="o">.</span><span class="n">json</span><span class="err">`</span><span class="p">:</span><span class="o">**</span><span class="w"> </span><span class="n">Provides</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">simplified</span><span class="o">-</span><span class="n">technical</span><span class="o">-</span><span class="n">english</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="w"> </span><span class="n">script</span><span class="o">.</span>
<span class="o">*</span><span class="w">   </span><span class="o">**</span><span class="err">`</span><span class="n">examples</span><span class="o">/</span><span class="n">basic</span><span class="o">-</span><span class="n">english</span><span class="o">-</span><span class="ow">in</span><span class="o">.</span><span class="n">json</span><span class="err">`</span><span class="p">:</span><span class="o">**</span><span class="w">  </span><span class="n">Likely</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">hold</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="err">`</span><span class="n">basic</span><span class="o">-</span><span class="n">english</span><span class="o">.</span><span class="n">py</span><span class="err">`</span><span class="w"> </span><span class="n">functionality</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">exists</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">content</span><span class="o">.</span>

<span class="c1">## Code Examples and Explanations</span>

<span class="c1">### `simplified-technical-english.py`</span>

<span class="err">```</span><span class="n">python</span>
<span class="c1"># simplified-technical-english.py</span>
<span class="n">import</span><span class="w"> </span><span class="n">json</span>
<span class="n">import</span><span class="w"> </span><span class="n">sys</span>
<span class="n">from</span><span class="w"> </span><span class="n">datetime</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">datetime</span>
<span class="n">from</span><span class="w"> </span><span class="n">routines</span><span class="o">.</span><span class="n">llm</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">chat_with_llm</span><span class="p">,</span><span class="w"> </span><span class="n">parse_llm_json_response</span>
<span class="n">from</span><span class="w"> </span><span class="n">routines</span><span class="o">.</span><span class="n">utils</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">load_json</span><span class="p">,</span><span class="w"> </span><span class="n">saveToFile</span><span class="p">,</span><span class="w"> </span><span class="n">get_output_filepath</span><span class="p">,</span><span class="w"> </span><span class="n">handle_command_args</span>

<span class="n">def</span><span class="w"> </span><span class="n">generate_page_metadata</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span><span class="w"> </span><span class="n">save_inputs</span><span class="o">=</span><span class="n">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates metadata for a Universal Automation Wiki page about a given topic.&quot;&quot;&quot;</span>
<span class="w">    </span><span class="n">topic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;topic&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;temperature&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.7</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;max_tokens&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">})</span>
<span class="w">    </span><span class="n">global</span><span class="w"> </span><span class="n">flowUUID</span><span class="w">  </span><span class="c1"># Access the global flowUUID variable</span>

<span class="w">    </span><span class="n">systemMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="s2">&quot;You are a Universal Automation Wiki page generator. &quot;</span>
<span class="w">        </span><span class="s2">&quot;Your task is to create JSON metadata for a wiki page about a given topic.</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="s2">&quot;Include the following fields:</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="s2">&quot;- title (string): A concise title for the wiki page.</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="s2">&quot;- automation_potential (integer): Estimated current progress toward full automation (as a percentage). BE CRITICAL, do not exaggerate current status. E.g., &#39;25%&#39; would be appropriate for topics where some partial automation is POSSIBLE.</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="s2">&quot;- Explanatory text (2-3 FULL paragraphs) that describes the topic and its automation journey.</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="s2">&quot;Format your response as a JSON object with these fields.&quot;</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="n">user_msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;Create metadata for a Universal Automation Wiki page about: {topic}&quot;</span>

<span class="w">    </span><span class="c1"># Save inputs to file if requested</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">save_inputs</span><span class="p">:</span>
<span class="w">        </span><span class="n">save_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;flow/{flowUUID}/inputs/1-in.json&quot;</span>
<span class="w">        </span><span class="n">saveToFile</span><span class="p">(</span><span class="n">systemMsg</span><span class="p">,</span><span class="w"> </span><span class="n">user_msg</span><span class="p">,</span><span class="w"> </span><span class="n">save_path</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Use chat_with_llm to generate metadata</span>
<span class="w">    </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">chat_with_llm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">systemMsg</span><span class="p">,</span><span class="w"> </span><span class="n">user_msg</span><span class="p">,</span><span class="w"> </span><span class="n">parameters</span><span class="p">)</span>
<span class="w">    </span><span class="c1"># Parse JSON using shared utility to extract JSON block reliably</span>
<span class="w">    </span><span class="n">metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parse_llm_json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">dict</span><span class="p">):</span>
<span class="w">        </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Parsed metadata is not a JSON object. Full response: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">response</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">None</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">metadata</span>
</code></pre></div>

<p>This function takes a topic as input and uses an LLM to generate metadata for a wiki page.  It constructs a system message and user message to prompt the LLM, then parses the LLM's response to extract the metadata.</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_automation_adoption_phases</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">save_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates phases of automation adoption for a given topic.&quot;&quot;&quot;</span>
    <span class="n">topic</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;topic&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;max_tokens&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">})</span>
    <span class="k">global</span> <span class="n">flowUUID</span>  <span class="c1"># Access the global flowUUID variable</span>

    <span class="n">systemMsg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;You are an expert in automation technologies and processes.&quot;</span>
        <span class="s2">&quot;Your task is to outline the phases of automation adoption for a given topic.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;End-to-End Automation (Future development)</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;For each phase:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;1. Provide 4-6 specific examples of automation technology or processes</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;2. Make sure the automation complexity increases with each phase</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;3. Be specific to the domain rather than generic</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Format your response as a JSON object with the following structure:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;{</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase1</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;    </span><span class="se">\&quot;</span><span class="s2">title</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Basic Mechanical Assistance</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;    </span><span class="se">\&quot;</span><span class="s2">status</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Currently widespread</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;    </span><span class="se">\&quot;</span><span class="s2">examples</span><span class="se">\&quot;</span><span class="s2">: [</span><span class="se">\&quot;</span><span class="s2">example1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">example2</span><span class="se">\&quot;</span><span class="s2">, ...]</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  },</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase2</span><span class="se">\&quot;</span><span class="s2">: { ... },</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase3</span><span class="se">\&quot;</span><span class="s2">: { ... },</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase4</span><span class="se">\&quot;</span><span class="s2">: { ... }</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Only include examples that are significantly relevant to the topic.&quot;</span>
    <span class="p">)</span>

    <span class="n">user_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Outline the phases of automation adoption for: </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Save inputs to file if requested</span>
    <span class="k">if</span> <span class="n">save_inputs</span><span class="p">:</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;flow/</span><span class="si">{</span><span class="n">flowUUID</span><span class="si">}</span><span class="s2">/inputs/5-in.json&quot;</span>
        <span class="n">saveToFile</span><span class="p">(</span><span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">save_path</span><span class="p">)</span>

    <span class="c1"># Use chat_with_llm to generate automation adoption phases</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat_with_llm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Try to parse JSON response</span>
        <span class="n">adoption_phases</span> <span class="o">=</span> <span class="n">parse_llm_json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">adoption_phases</span>
    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: LLM response is not valid JSON. Full response: &quot;</span> <span class="o">+</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>

<p>This function outlines the phases of automation adoption for a given topic using an LLM.  It provides a system message that instructs the LLM to generate a JSON object with phases, titles, statuses, and examples of automation technologies.</p>
<h2>Component Architecture</h2>
<p>The <code>simplified-technical-english.py</code> script relies on the <code>chat_with_llm</code> function to interact with an LLM and <code>parse_llm_json_response</code> to handle the LLM's output.  The <code>routines.utils</code> module provides utility functions for file handling and argument parsing.</p>
<div class="codehilite"><pre><span></span><code><span class="n">graph</span><span class="w"> </span><span class="n">TD</span>
<span class="w">    </span><span class="n">subgraph</span><span class="w"> </span><span class="n">Routines</span>
<span class="w">        </span><span class="n">LLM</span><span class="o">[</span><span class="n">chat_with_llm</span><span class="o">]</span>
<span class="w">        </span><span class="n">JSON</span><span class="o">[</span><span class="n">parse_llm_json_response</span><span class="o">]</span>
<span class="w">        </span><span class="n">UTILS</span><span class="o">[</span><span class="n">routines.utils</span><span class="o">]</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="n">STE</span><span class="o">[</span><span class="n">simplified-technical-english.py</span><span class="o">]</span><span class="w"> </span><span class="c1">--&gt; LLM</span>
<span class="w">    </span><span class="n">STE</span><span class="w"> </span><span class="c1">--&gt; JSON</span>
<span class="w">    </span><span class="n">STE</span><span class="w"> </span><span class="c1">--&gt; UTILS</span>
<span class="w">    </span><span class="n">EXAMPLES</span><span class="o">[</span><span class="n">examples/simplified-technical-english-in.json</span><span class="o">]</span><span class="w"> </span><span class="c1">--&gt; STE</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">STE</span><span class="w"> </span><span class="nl">fill</span><span class="p">:</span><span class="n">#f9f</span><span class="p">,</span><span class="nl">stroke</span><span class="p">:</span><span class="n">#333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="nl">width</span><span class="p">:</span><span class="mi">2</span><span class="n">px</span>
</code></pre></div>

<h2>Data Flow</h2>
<p>The data flow for <code>generate_page_metadata</code> and <code>generate_automation_adoption_phases</code> involves loading input data, constructing prompts, sending prompts to the LLM, parsing the LLM's response, and returning the extracted metadata.</p>
<div class="codehilite"><pre><span></span><code><span class="n">sequenceDiagram</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">User</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">STE</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">LLM</span>
<span class="w">    </span><span class="n">participant</span><span class="w"> </span><span class="n">JSON</span>

<span class="w">    </span><span class="n">User</span><span class="o">-&gt;&gt;</span><span class="n">STE</span><span class="o">:</span><span class="w"> </span><span class="n">Input</span><span class="w"> </span><span class="kt">Data</span><span class="w"> </span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>
<span class="w">    </span><span class="n">STE</span><span class="o">-&gt;&gt;</span><span class="n">STE</span><span class="o">:</span><span class="w"> </span><span class="n">Construct</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">Messages</span>
<span class="w">    </span><span class="n">STE</span><span class="o">-&gt;&gt;</span><span class="n">LLM</span><span class="o">:</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="n">Prompt</span>
<span class="w">    </span><span class="n">LLM</span><span class="o">-&gt;&gt;</span><span class="n">STE</span><span class="o">:</span><span class="w"> </span><span class="n">LLM</span><span class="w"> </span><span class="n">Response</span><span class="w"> </span><span class="p">(</span><span class="n">JSON</span><span class="w"> </span><span class="n">String</span><span class="p">)</span>
<span class="w">    </span><span class="n">STE</span><span class="o">-&gt;&gt;</span><span class="n">JSON</span><span class="o">:</span><span class="w"> </span><span class="nf">Parse</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="n">Response</span>
<span class="w">    </span><span class="n">JSON</span><span class="o">-&gt;&gt;</span><span class="n">STE</span><span class="o">:</span><span class="w"> </span><span class="n">Metadata</span><span class="w"> </span><span class="p">(</span><span class="n">Dict</span><span class="p">)</span>
<span class="w">    </span><span class="n">STE</span><span class="o">-&gt;&gt;</span><span class="n">User</span><span class="o">:</span><span class="w"> </span><span class="kr">Return</span><span class="w"> </span><span class="n">Metadata</span>
</code></pre></div>

<h2>Usage Instructions</h2>
<ol>
<li><strong>Setup:</strong> Ensure you have the <code>routines</code> repository set up with the necessary dependencies, including access to an LLM (e.g., OpenAI API key configured).</li>
<li><strong>Input:</strong> Create a JSON file similar to <code>examples/simplified-technical-english-in.json</code> with the desired topic and model parameters.</li>
<li><strong>Execution:</strong> Run the <code>simplified-technical-english.py</code> script, providing the input JSON file as an argument.  Optionally, specify an output file to save the generated metadata.</li>
</ol>
<p>Example command-line usage:</p>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>simplified-technical-english.py<span class="w"> </span>examples/simplified-technical-english-in.json<span class="w"> </span>output.json
</code></pre></div>

<h2>Future Development</h2>
<p>The <code>basic-english.py</code> file is currently a placeholder.  Future development could focus on implementing functionality to convert text to Basic English using rule-based systems, machine translation models, or a combination of both.  This would involve:</p>
<ol>
<li>Developing a Basic English lexicon and grammar rules.</li>
<li>Creating a parsing and transformation pipeline.</li>
<li>Adding evaluation metrics to assess the quality of the Basic English conversion.</li>
<li>Creating example input and output files for testing.</li>
</ol>
<hr />
<p><a id='page-6'></a></p>
<h2>Search Query Generation and Information Retrieval</h2>
<h3>Related Files</h3>
<ul>
<li><code>search-queries.py</code></li>
<li><code>examples/search-queries-in.json</code></li>
<li><code>examples/search-queries-out.json</code></li>
</ul>
<h2>Search Query Generation and Information Retrieval</h2>
<p>This page details the <code>search-queries.py</code> script within the <code>routines</code> repository, along with its associated input and output examples. This script focuses on generating search queries and retrieving information, likely for tasks such as data collection, research, or automated information gathering.</p>
<h3>Purpose and Functionality</h3>
<p>The <code>search-queries.py</code> script is designed to automate the process of generating search queries based on a given topic and retrieving relevant information. It leverages Large Language Models (LLMs) to create the search queries and likely uses an information retrieval mechanism (not explicitly defined in the provided code but implied) to fetch and process the search results. The script takes a topic as input, communicates with an LLM to generate metadata, automation adoption phases, and detailed industrial specifications related to the topic, which can then be used to formulate specific search queries.</p>
<h3>Code Examples and Explanation</h3>
<p>The core functionality revolves around the <code>generate_page_metadata</code>, <code>generate_automation_adoption</code>, and <code>generate_industrial_specifications</code> functions. These functions construct system and user messages to prompt an LLM, then parse the LLM's JSON response.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># File: search-queries.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">utils</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">load_json</span><span class="p">,</span> <span class="n">save_output</span><span class="p">,</span> <span class="n">chat_with_llm</span><span class="p">,</span> <span class="n">parse_llm_json_response</span><span class="p">,</span>
    <span class="n">create_output_metadata</span><span class="p">,</span> <span class="n">get_output_filepath</span><span class="p">,</span> <span class="n">handle_command_args</span><span class="p">,</span>
    <span class="n">saveToFile</span>
<span class="p">)</span>

<span class="n">flowUUID</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Global variable for flow UUID</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_page_metadata</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">save_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate standardized metadata for a topic page.&quot;&quot;&quot;</span>
    <span class="c1"># Extract information from input data</span>
    <span class="n">topic</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;topic&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;gemma3&quot;</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="c1"># If input already contains metadata fields, use them directly</span>
    <span class="k">if</span> <span class="s2">&quot;metadata&quot;</span> <span class="ow">in</span> <span class="n">input_data</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">input_data</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>

    <span class="c1"># Otherwise, generate metadata using LLM</span>
    <span class="n">systemMsg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;You are an AI assistant specialized in creating consistent metadata for technical topics. &quot;</span>
        <span class="s2">&quot;Generate appropriate metadata for the topic provided, including: &quot;</span>
        <span class="s2">&quot;- A descriptive title (using the topic name) MAXIMUM 2-3 WORDS DO NOT INCLDUE A SUBTITLE (e.g., ANYTHING AFTER A SEMICOLON) &quot;</span>
        <span class="s2">&quot;- A subtitle that explains the scope &quot;</span>
        <span class="s2">&quot;- Current automation status (No Automation, Very Early Automation, Early Automation, Some Automation, Partially Fully Automated, Mostly Fully Automated, or Fully Automated) &quot;</span>
        <span class="s2">&quot;- Percentage estimate of progress toward full automation (as a percentage). BE CRITICAL, do not exaggerate current status. E.g., &#39;25%&#39; would be appropriate for topics where some partial automation is POSSIBLE.&quot;</span>
        <span class="s2">&quot;- Explanatory text (2-3 FULL paragraphs) that describes the topic and its automation journey.&quot;</span>
        <span class="s2">&quot;Format your response as a JSON object with these fields.&quot;</span>
    <span class="p">)</span>

    <span class="n">user_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Create metadata for a Universal Automation Wiki page about: </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Save inputs to file if requested</span>
    <span class="k">if</span> <span class="n">save_inputs</span><span class="p">:</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;flow/</span><span class="si">{</span><span class="n">flowUUID</span><span class="si">}</span><span class="s2">/inputs/1-in.json&quot;</span>
        <span class="n">saveToFile</span><span class="p">(</span><span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">save_path</span><span class="p">)</span>

    <span class="c1"># Use chat_with_llm to generate metadata</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat_with_llm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
    <span class="c1"># Parse JSON using shared utility to extract JSON block reliably</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">parse_llm_json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Parsed metadata is not a JSON object. Full response: &quot;</span> <span class="o">+</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">metadata</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_automation_adoption</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">save_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate detailed information about automation adoption phases for a specific topic.&quot;&quot;&quot;</span>
    <span class="c1"># Extract information from input data</span>
    <span class="n">topic</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;topic&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;gemma3&quot;</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="c1"># Generate automation adoption phases using LLM</span>
    <span class="n">systemMsg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;You are an AI assistant specialized in analyzing automation adoption patterns. &quot;</span>
        <span class="s2">&quot;Your task is to identify and explain the different phases of automation adoption &quot;</span>
        <span class="s2">&quot;in a specific field or topic, from basic mechanical assistance to full end-to-end automation.&quot;</span>
    <span class="p">)</span>

    <span class="n">user_msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Create a detailed breakdown of automation adoption phases for: </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Please structure your response in 4 phases:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Phase 1: Basic Mechanical Assistance (Currently widespread)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Phase 2: Integrated Semi-Automation (Currently in transition)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Phase 3: Advanced Automation Systems (Emerging technology)</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Phase 4: Full End-to-End Automation (Future development)</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;For each phase:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;1. Provide 4-6 specific examples of automation technology or processes</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;2. Make sure the automation complexity increases with each phase</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;3. Be specific to the domain rather than generic</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Format your response as a JSON object with the following structure:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;{</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase1</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;    </span><span class="se">\&quot;</span><span class="s2">title</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Basic Mechanical Assistance</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;    </span><span class="se">\&quot;</span><span class="s2">status</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">Currently widespread</span><span class="se">\&quot;</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;    </span><span class="se">\&quot;</span><span class="s2">examples</span><span class="se">\&quot;</span><span class="s2">: [</span><span class="se">\&quot;</span><span class="s2">example1</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">example2</span><span class="se">\&quot;</span><span class="s2">, ...]</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  },</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase2</span><span class="se">\&quot;</span><span class="s2">: { ... },</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase3</span><span class="se">\&quot;</span><span class="s2">: { ... },</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;  </span><span class="se">\&quot;</span><span class="s2">phase4</span><span class="se">\&quot;</span><span class="s2">: { ... }</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="s2">&quot;Only include examples that are significantly relevant to the topic.&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Save inputs to file if requested</span>
    <span class="k">if</span> <span class="n">save_inputs</span><span class="p">:</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;flow/</span><span class="si">{</span><span class="n">flowUUID</span><span class="si">}</span><span class="s2">/inputs/5-in.json&quot;</span>
        <span class="n">saveToFile</span><span class="p">(</span><span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">save_path</span><span class="p">)</span>

    <span class="c1"># Use chat_with_llm to generate automation adoption phases</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat_with_llm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Try to parse JSON response</span>
        <span class="n">adoption_phases</span> <span class="o">=</span> <span class="n">parse_llm_json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">adoption_phases</span>
    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: LLM response is not valid JSON. Full response: &quot;</span> <span class="o">+</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">generate_industrial_specifications</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">save_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate detailed industrial specifications for a given topic.&quot;&quot;&quot;</span>
    <span class="c1"># Extract information from input data</span>
    <span class="n">topic</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;topic&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;gemma3&quot;</span><span class="p">)</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;parameters&quot;</span><span class="p">,</span> <span class="p">{})</span>

    <span class="c1"># Define the system message for the LLM</span>
    <span class="n">systemMsg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;You are an AI assistant specialized in industrial engineering and specifications. &quot;</span>
        <span class="s2">&quot;For the given topic, provide a comprehensive overview of industrial/commercial specifications &quot;</span>
        <span class="s2">&quot;including performance metrics and implementation requirements. &quot;</span>
        <span class="s2">&quot;Be precise with numerical values and include ranges where appropriate. &quot;</span>
        <span class="s2">&quot;Focus on practical technical details that would be relevant to professionals in the field.&quot;</span>
    <span class="p">)</span>

    <span class="n">user_msg</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Create detailed industrial specifications for: </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;Format your response as a JSON object with these categories:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;1. performance_metrics: An array of metrics with names, values/ranges, and descriptions</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;2. implementation_requirements: An array of requirements with names, specifications, and descriptions</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;3. industry_standards: An array of relevant standards and certifications</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;4. key_suppliers: An array of major equipment/technology suppliers for this industry</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;5. operational_considerations: An array of important operational factors</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Please provide realistic values for industrial/commercial scale implementations.</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Return ONLY valid JSON without any additional text, explanation, or code block formatting.&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Save inputs to file if requested</span>
    <span class="k">if</span> <span class="n">save_inputs</span><span class="p">:</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;flow/</span><span class="si">{</span><span class="n">flowUUID</span><span class="si">}</span><span class="s2">/inputs/9-in.json&quot;</span>
        <span class="n">saveToFile</span><span class="p">(</span><span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="c1"># Use chat_with_llm to generate industrial specifications</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chat_with_llm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">systemMsg</span><span class="p">,</span> <span class="n">user_msg</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

    <span class="c1"># Parse JSON response</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">industrial_specs</span> <span class="o">=</span> <span class="n">parse_llm_json_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">industrial_specs</span>
    <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: LLM response is not valid JSON. Full response: &quot;</span> <span class="o">+</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main function to run the metadata generation.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">flowUUID</span>
    <span class="n">usage_msg</span> <span class="o">=</span> <span class="s2">&quot;Usage: python generate-metadata.py &lt;input_json&gt; [output_json] [-saveInputs] [-uuid=</span><span class="se">\&quot;</span><span class="s2">UUID</span><span class="se">\&quot;</span><span class="s2">] [-flow_uuid=</span><span class="se">\&quot;</span><span class="s2">FLOW-UUID</span><span class="se">\&quot;</span><span class="s2">]&quot;</span>
    <span class="n">input_filepath</span><span class="p">,</span> <span class="n">specified_output_filepath</span><span class="p">,</span> <span class="n">save_inputs</span><span class="p">,</span> <span class="n">custom_uuid</span><span class="p">,</span> <span class="n">flow_uuid_arg</span> <span class="o">=</span> <span class="n">handle_command_args</span><span class="p">(</span><span class="n">usage_msg</span><span class="p">)</span>
    <span class="n">flowUUID</span> <span class="o">=</span> <span class="n">flow_uuid_arg</span> <span class="c1"># Set the global variable</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Working...&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

    <span class="n">input_data</span> <span class="o">=</span> <span class="n">load_json</span><span class="p">(</span><span class="n">input_filepath</span><span class="p">)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">generate_page_metadata</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">save_inputs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to generate metadata.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Get output filepath and UUID</span>
    <span class="n">output_filepath</span><span class="p">,</span> <span class="n">output_uuid</span> <span class="o">=</span> <span class="n">get_output_filepath</span><span class="p">(</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">,</span> 
        <span class="n">specified_output_filepath</span><span class="p">,</span> 
        <span class="n">custom_uuid</span>
    <span class="p">)</span>

    <span class="c1"># Create output metadata</span>
    <span class="n">output_metadata</span> <span class="o">=</span> <span class="n">create_output_metadata</span><span class="p">(</span>
        <span class="n">input_filepath</span><span class="p">,</span> 
        <span class="n">output_filepath</span><span class="p">,</span> 
        <span class="n">start_time</span><span class="p">,</span> 
        <span class="n">input_data</span><span class="p">,</span> 
        <span class="n">metadata</span>
    <span class="p">)</span>

    <span class="c1"># Save the output</span>
    <span class="n">save_output</span><span class="p">(</span><span class="n">output_metadata</span><span class="p">,</span> <span class="n">output_filepath</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metadata generated and saved to </span><span class="si">{</span><span class="n">output_filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

<p>The <code>main</code> function handles command-line arguments, loads input data (likely containing the topic and LLM parameters), calls the <code>generate_page_metadata</code> function, and saves the output. The <code>utils</code> module (not shown in full, but imported) contains helper functions for loading JSON, saving output, interacting with the LLM, parsing JSON responses, and handling file paths.</p>
<h3>Component Relationships and Data Flow</h3>
<div class="codehilite"><pre><span></span><code><span class="n">graph</span><span class="w"> </span><span class="n">TD</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">Input</span><span class="w"> </span><span class="n">JSON</span><span class="o">:</span><span class="w"> </span><span class="n">Topic</span><span class="p">,</span><span class="w"> </span><span class="n">Model</span><span class="p">,</span><span class="w"> </span><span class="n">Parameters</span><span class="p">]</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">generate_page_metadata</span><span class="p">)</span>
<span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">{</span><span class="n">LLM</span><span class="w"> </span><span class="n">Interaction</span><span class="o">:</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">Messages</span><span class="p">}</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">D</span><span class="p">[</span><span class="n">LLM</span><span class="w"> </span><span class="n">Response</span><span class="o">:</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="n">Metadata</span><span class="p">]</span>
<span class="w">    </span><span class="n">D</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">E</span><span class="p">(</span><span class="n">parse_llm_json_response</span><span class="p">)</span>
<span class="w">    </span><span class="n">E</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">F</span><span class="p">{</span><span class="n">Metadata</span><span class="w"> </span><span class="n">Dictionary</span><span class="p">}</span>
<span class="w">    </span><span class="n">F</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">G</span><span class="p">(</span><span class="n">create_output_metadata</span><span class="p">)</span>
<span class="w">    </span><span class="n">G</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">H</span><span class="p">[</span><span class="n">Output</span><span class="w"> </span><span class="n">JSON</span><span class="o">:</span><span class="w"> </span><span class="n">Metadata</span><span class="p">,</span><span class="w"> </span><span class="n">Provenance</span><span class="p">]</span>
<span class="w">    </span><span class="n">H</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">I</span><span class="p">(</span><span class="n">save_output</span><span class="p">)</span>
<span class="w">    </span><span class="n">I</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">J</span><span class="p">[</span><span class="n">Output</span><span class="w"> </span><span class="n">File</span><span class="p">]</span>
</code></pre></div>

<h3>Overall Architecture</h3>
<p>The architecture is centered around using an LLM to generate structured data (metadata, automation phases, specifications) from a given topic. The script orchestrates the interaction with the LLM and handles the input/output.</p>
<h3>Setup and Usage Instructions</h3>
<ol>
<li><strong>Install Dependencies:</strong> Ensure you have the necessary libraries installed.  The script relies on <code>utils.py</code>, <code>load_json</code>, <code>save_output</code>, <code>chat_with_llm</code>, <code>parse_llm_json_response</code>, <code>create_output_metadata</code>, <code>get_output_filepath</code>, <code>handle_command_args</code>, and <code>saveToFile</code> which are not standard Python libraries.  You'll need to ensure these are available, likely from the same repository. Install <code>json</code> which is part of the standard library.</li>
<li><strong>Configure LLM Access:</strong>  The script uses a <code>chat_with_llm</code> function, which implies access to an LLM.  Configure the necessary API keys or access credentials for the chosen LLM (specified by the <code>model</code> parameter in the input JSON).</li>
<li><strong>Prepare Input JSON:</strong> Create an input JSON file containing the <code>topic</code> and any optional <code>model</code> and <code>parameters</code> for the LLM.  See <code>examples/search-queries-in.json</code> for the expected format.</li>
<li>
<p><strong>Run the Script:</strong> Execute the <code>search-queries.py</code> script from the command line, providing the path to the input JSON file as an argument.  Optionally, specify an output file path and other flags.</p>
<p><code>bash
python search-queries.py examples/search-queries-in.json examples/search-queries-out.json -saveInputs</code></p>
</li>
</ol>
<h3>Input and Output Examples</h3>
<p>The <code>examples/search-queries-in.json</code> file provides a sample input:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;topic&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cloud Computing&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;model&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gemma3&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;temperature&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.7</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>The <code>examples/search-queries-out.json</code> file (hypothetically) contains the generated metadata:</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;examples/search-queries-in.json&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;output_file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;examples/search-queries-out.json&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;start_time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-01-01T12:00:00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;input_data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;topic&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cloud Computing&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;model&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gemma3&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;temperature&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.7</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cloud Computing&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;subtitle&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Overview and Scope&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;automation_status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Some Automation&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;progress_percentage&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;explanatory_text&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;Cloud computing has seen some automation in areas like resource provisioning and scaling. However, many aspects still require manual intervention, such as security configuration and complex deployment scenarios.&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;Further automation is being explored through technologies like Infrastructure as Code (IaC) and automated compliance checks, aiming for more efficient and reliable cloud environments.&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3>Automation Adoption Phases</h3>
<p>The <code>generate_automation_adoption</code> function produces a structured breakdown of automation adoption, which could be visualized as follows:</p>
<div class="codehilite"><pre><span></span><code><span class="nf">graph</span><span class="w"> </span><span class="n">TD</span>
<span class="w">    </span><span class="n">A</span><span class="p">[</span><span class="n">Basic</span><span class="w"> </span><span class="n">Mechanical</span><span class="w"> </span><span class="n">Assistance</span><span class="p">]</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">Integrated</span><span class="w"> </span><span class="n">Semi</span><span class="o">-</span><span class="n">Automation</span><span class="p">]</span>
<span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">Advanced</span><span class="w"> </span><span class="n">Automation</span><span class="w"> </span><span class="n">Systems</span><span class="p">]</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">D</span><span class="p">[</span><span class="kr">Full</span><span class="w"> </span><span class="kd">End-</span><span class="n">to</span><span class="o">-</span><span class="kd">End </span><span class="n">Automation</span><span class="p">]</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">f9f</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">ccf</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">ccf</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
<span class="w">    </span><span class="n">style</span><span class="w"> </span><span class="n">D</span><span class="w"> </span><span class="n">fill</span><span class="o">:</span><span class="err">#</span><span class="n">f9f</span><span class="p">,</span><span class="n">stroke</span><span class="o">:</span><span class="err">#</span><span class="mi">333</span><span class="p">,</span><span class="n">stroke</span><span class="o">-</span><span class="n">width</span><span class="o">:</span><span class="mi">2</span><span class="n">px</span>
</code></pre></div>

<h3>Industrial Specifications</h3>
<p>The <code>generate_industrial_specifications</code> function aims to produce detailed technical specifications. This output is structured as a JSON object with categories like <code>performance_metrics</code>, <code>implementation_requirements</code>, <code>industry_standards</code>, <code>key_suppliers</code>, and <code>operational_considerations</code>. This structured output is well-suited for generating targeted search queries.</p>
<hr />
            </section>

        </main>
    </div>

    <div id="footer-placeholder"></div>

    <script src="/assets/js/components.js"></script>
<script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script src="/assets/js/main.js"></script>
    <script src="/assets/js/documentation.js"></script>
    <script>renderDocumentationSidebar('#sidebar-placeholder');</script>
</body>
</html>