<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industrial Specifications Generation - Universal Automation Wiki</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/components.css">
    <link rel="stylesheet" href="/assets/css/category.css">
    <link rel="stylesheet" href="/assets/css/responsive.css">
    <link rel="stylesheet" href="/assets/css/documentation.css">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600;700&family=Geologica:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* Placeholder styles to prevent layout shift */
        #header-placeholder { min-height: 70px; }
        #footer-placeholder { min-height: 250px; }
    </style>
</head>
<body>
    <div id="header-placeholder"></div>

    <div class="docs-container">
        <div class="docs-layout">
            <div id="sidebar-placeholder"></div>

            <main class="docs-main">
                <article class="docs-article">
                    <header class="docs-header">
                        <div class="docs-breadcrumb">
                            <nav aria-label="Breadcrumb">
                                <ol>
                                    
                                        
                                            <li><a href="/">Home</a></li>
                                        
                                    
                                        
                                            <li><a href="/docs/">Documentation</a></li>
                                        
                                    
                                        
                                            <li><a href="/docs/routines/">Routines</a></li>
                                        
                                    
                                        
                                            <li aria-current="page">Industrial Specifications Generation</li>
                                        
                                    
                                </ol>
                            </nav>
                        </div>
                        
                        <div class="docs-title-section">
                            <h1 class="docs-page-title">Industrial Specifications Generation</h1>
                            
                            <p class="docs-page-subtitle">This script utilizes a large language model (LLM), prompted to act as an industrial engineering specialist, to generate comprehensive industrial and commercial specifications for a user-provided topic. It expects the LLM to return a structured JSON object containing detailed information relevant to professionals in the field.</p>
                            
                        </div>
                    </header>

                    <div class="docs-content">
                        <p>This script utilizes a large language model (LLM), prompted to act as an industrial engineering specialist, to generate comprehensive industrial and commercial specifications for a user-provided topic. It expects the LLM to return a structured JSON object containing detailed information relevant to professionals in the field.</p>
<h2 class="docs-heading" id="purpose">Purpose<a class="headerlink" href="#purpose" title="Link to this section">¶</a></h2>
<p>The primary goal of this script is to automate the generation of detailed industrial specifications, including performance metrics, implementation requirements, relevant standards, key suppliers, and operational considerations for a specific topic.</p>
<h2 class="docs-heading" id="usage">Usage<a class="headerlink" href="#usage" title="Link to this section">¶</a></h2>
<p>The script is executed from the command line:</p>
<div class="codehilite"><pre><span></span><code class="language-text">python<span class="w"> </span>specifications-industrial.py<span class="w"> </span>&lt;input_json&gt;<span class="w"> </span><span class="o">[</span>output_json<span class="o">]</span><span class="w"> </span><span class="o">[</span>-saveInputs<span class="o">]</span><span class="w"> </span><span class="o">[</span>-uuid<span class="o">=</span><span class="s2">"UUID"</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>-flow_uuid<span class="o">=</span><span class="s2">"FLOW-UUID"</span><span class="o">]</span>
</code></pre></div>
<ul class="docs-list">
<li><code class="docs-inline-code">&lt;input_json&gt;</code>: (Required) Path to the input JSON file containing the topic and configuration.</li>
<li><code class="docs-inline-code">[output_json]</code>: (Optional) Path where the output JSON file should be saved. If omitted, a default path is generated.</li>
<li><code class="docs-inline-code">-saveInputs</code>: (Optional) Flag to save the system and user prompts sent to the LLM into the <code class="docs-inline-code">flow/&lt;flowUUID&gt;/inputs/</code> directory.</li>
<li><code class="docs-inline-code">-uuid="UUID"</code>: (Optional) Custom UUID for the output file metadata.</li>
<li><code class="docs-inline-code">-flow_uuid="FLOW-UUID"</code>: (Optional) UUID for the flow, used for saving inputs if <code class="docs-inline-code">-saveInputs</code> is specified.</li>
</ul>
<h2 class="docs-heading" id="input-files">Input Files<a class="headerlink" href="#input-files" title="Link to this section">¶</a></h2>
<p>The script requires an input JSON file (<code class="docs-inline-code">&lt;input_json&gt;</code>) with the following structure:</p>
<div class="codehilite"><pre><span></span><code class="language-text"><span class="p">{</span>
<span class="w">  </span><span class="nt">"topic"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The specific industrial topic (e.g., High-Volume Lithium-ion Battery Manufacturing)"</span><span class="p">,</span>
<span class="w">  </span><span class="nt">"model"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gemma3"</span><span class="p">,</span><span class="w"> </span><span class="c1">// Or another LLM model identifier</span>
<span class="w">  </span><span class="nt">"parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Optional LLM parameters (e.g., temperature, max_tokens)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul class="docs-list">
<li><code class="docs-inline-code">topic</code>: A string describing the subject for which specifications are needed.</li>
<li><code class="docs-inline-code">model</code>: The identifier for the LLM to use (defaults to <code class="docs-inline-code">gemma3</code> if not provided).</li>
<li><code class="docs-inline-code">parameters</code>: An optional object containing parameters to pass to the LLM during generation.</li>
</ul>
<h2 class="docs-heading" id="key-functions">Key Functions<a class="headerlink" href="#key-functions" title="Link to this section">¶</a></h2>
<ul class="docs-list">
<li><code class="docs-inline-code">main()</code>: Parses command-line arguments using <code class="docs-inline-code">handle_command_args</code>, loads the input JSON using <code class="docs-inline-code">load_json</code>, orchestrates the specification generation by calling <code class="docs-inline-code">generate_industrial_specifications</code>, determines the output path using <code class="docs-inline-code">get_output_filepath</code>, creates metadata using <code class="docs-inline-code">create_output_metadata</code>, combines metadata with the results, and saves the final output using <code class="docs-inline-code">save_output</code>. It also handles setting the global <code class="docs-inline-code">flowUUID</code>.</li>
<li><code class="docs-inline-code">generate_industrial_specifications(input_data, save_inputs=False)</code>: Extracts the <code class="docs-inline-code">topic</code>, <code class="docs-inline-code">model</code>, and <code class="docs-inline-code">parameters</code> from the input data. Constructs the system and user prompts for the LLM. Optionally saves these prompts using <code class="docs-inline-code">saveToFile</code> (from <code class="docs-inline-code">utils</code>). Calls <code class="docs-inline-code">chat_with_llm</code> (from <code class="docs-inline-code">utils</code>) to interact with the LLM. Processes the LLM response using <code class="docs-inline-code">extract_json_from_response</code>.</li>
<li><code class="docs-inline-code">extract_json_from_response(response)</code>: Attempts to robustly extract and parse a JSON object from the LLM’s potentially messy response string. It tries direct parsing, then looks for JSON within <code class="docs-inline-code">json ...</code> or <code class="docs-inline-code">...</code> code fences, and finally searches for content between the first <code class="docs-inline-code">{</code> and last <code class="docs-inline-code">}</code>. It uses <code class="docs-inline-code">sanitize_json_string</code> before attempting to parse.</li>
<li><code class="docs-inline-code">sanitize_json_string(json_str)</code>: Removes invalid control characters (ASCII 0-31, excluding tab, newline, carriage return) from a string using regular expressions to prevent JSON parsing errors.</li>
<li><strong>Utility Functions (<code class="docs-inline-code">utils</code>)</strong>: The script relies heavily on shared functions from <code class="docs-inline-code">utils.py</code>, including <code class="docs-inline-code">load_json</code>, <code class="docs-inline-code">save_output</code>, <code class="docs-inline-code">chat_with_llm</code>, <code class="docs-inline-code">create_output_metadata</code>, <code class="docs-inline-code">get_output_filepath</code>, <code class="docs-inline-code">handle_command_args</code>, and <code class="docs-inline-code">saveToFile</code>.</li>
</ul>
<h2 class="docs-heading" id="llm-interaction">LLM Interaction<a class="headerlink" href="#llm-interaction" title="Link to this section">¶</a></h2>
<p>The script crafts specific prompts to guide the LLM:</p>
<ul class="docs-list">
<li><strong>System Prompt</strong>: Instructs the LLM to act as an AI assistant specialized in industrial engineering and specifications. It requests a comprehensive overview for the given topic, including performance metrics and implementation requirements, emphasizing precision with numerical values/ranges and practical technical details relevant to professionals.</li>
<li><strong>User Prompt</strong>: Provides the specific <code class="docs-inline-code">topic</code> from the input file. It explicitly requests the output format as a JSON object with specific top-level keys:<ul class="docs-list">
<li><code class="docs-inline-code">performance_metrics</code>: Array of objects (name, value/range, description).</li>
<li><code class="docs-inline-code">implementation_requirements</code>: Array of objects (name, specification, description).</li>
<li><code class="docs-inline-code">industry_standards</code>: Array of relevant standards/certifications.</li>
<li><code class="docs-inline-code">key_suppliers</code>: Array of major equipment/technology suppliers.</li>
<li><code class="docs-inline-code">operational_considerations</code>: Array of important operational factors.
The prompt stresses the need for realistic values for industrial/commercial scale and demands <em>only</em> valid JSON output, without any surrounding text or formatting.</li>
</ul>
</li>
<li><strong>LLM Call</strong>: The <code class="docs-inline-code">chat_with_llm</code> function (from <code class="docs-inline-code">utils</code>) is used to send these prompts to the specified LLM and retrieve the response.</li>
</ul>
<h2 class="docs-heading" id="json-handling">JSON Handling<a class="headerlink" href="#json-handling" title="Link to this section">¶</a></h2>
<p>Robust JSON handling is crucial due to the variability of LLM outputs:</p>
<ul class="docs-list">
<li><strong>Sanitization (<code class="docs-inline-code">sanitize_json_string</code>)</strong>: Before any parsing attempt, the raw LLM response is cleaned to remove control characters that are invalid in JSON strings but might be present in the LLM output.</li>
<li><strong>Extraction (<code class="docs-inline-code">extract_json_from_response</code>)</strong>: This function implements a multi-stage strategy to find and parse the JSON:<ol class="docs-list docs-list-ordered">
<li>Tries parsing the sanitized response directly.</li>
<li>If that fails, looks for markdown code fences (<code class="docs-inline-code">json ...</code> or <code class="docs-inline-code">...</code>) and attempts to parse the content within them.</li>
<li>If that fails, finds the first opening curly brace <code class="docs-inline-code">{</code> and the last closing curly brace <code class="docs-inline-code">}</code> and attempts to parse the substring between them.
This approach increases the likelihood of successfully extracting the desired JSON even if the LLM includes introductory text, explanations, or incorrect formatting. These helper functions are identical to those used in <code class="docs-inline-code">return-analysis.py</code>.</li>
</ol>
</li>
</ul>
<h2 class="docs-heading" id="output">Output<a class="headerlink" href="#output" title="Link to this section">¶</a></h2>
<p>The script generates a JSON file (at the path determined by <code class="docs-inline-code">get_output_filepath</code> or specified by the user) containing:</p>
<ul class="docs-list">
<li><code class="docs-inline-code">process_metadata</code>: Standard metadata including script name, start time, duration, and UUID (generated by <code class="docs-inline-code">create_output_metadata</code>).</li>
<li><code class="docs-inline-code">industrial_specifications</code>: The structured JSON object containing the specifications as generated by the LLM and successfully parsed by <code class="docs-inline-code">extract_json_from_response</code>.</li>
</ul>
<p>If <code class="docs-inline-code">extract_json_from_response</code> fails to return a valid JSON object from the LLM response, the script prints an error message, shows the raw response, and exits with a non-zero status code.</p>
                    </div>
                    
                    <footer class="docs-footer">
                        <div class="docs-meta">
                            <p>Part of the <a href="/">Universal Automation Wiki</a> documentation</p>
                        </div>
                    </footer>
                </article>
            </main>
        </div>
    </div>

    <div id="footer-placeholder"></div>

    <script src="/assets/js/components.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'neutral',
            themeVariables: {
                primaryColor: '#126ca8',
                primaryTextColor: '#333',
                primaryBorderColor: '#e0e0e0',
                lineColor: '#666'
            }
        });
    </script>
    <script src="/assets/js/main.js"></script>
    <script src="/assets/js/documentation.js"></script>
    <script>renderDocumentationSidebar('#sidebar-placeholder');</script>
</body>
</html>